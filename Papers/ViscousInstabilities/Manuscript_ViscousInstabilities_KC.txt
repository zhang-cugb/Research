%  LocalWords:  checkboard
% Copyright 2007, 2008, 2009 Elsevier Ltd
%
% This file is part of the 'Elsarticle Bundle'.
% ---------------------------------------------
%
% It may be distributed under the conditions of the LaTeX Project Public
% License, either version 1.2 of this license or (at your option) any
% later version.  The latest version of this license is in
%    http://www.latex-project.org/lppl.txt
% and version 1.2 or later is part of all distributions of LaTeX
% version 1999/12/01 or later c.
%
% The list of all files belonging to the 'Elsarticle Bundle' is
% given in the file `manifest.txt'.
%

% Template article for Elsevier's document class `elsarticle'
% with harvard style bibliographic references
% SP 2008/03/01
%
%
%
% $Id: elsarticle-template-harv.tex 4 2009-10-24 08:22:58Z rishi $
%
%
\documentclass[preprint,authoryear,12pt]{elsarticle}

% Use the option review to obtain double line spacing
%\documentclass[authoryear,preprint,review,12pt]{elsarticle}

% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
% for a journal layout:
%\documentclass[final,authoryear,1p,times]{elsarticle}
%\documentclass[final,authoryear,1p,times,twocolumn]{elsarticle}
%\documentclass[final,authoryear,3p,times]{elsarticle}
%\documentclass[final,authoryear,3p,times,twocolumn]{elsarticle}
%\documentclass[final,authoryear,5p,times]{elsarticle}
%\documentclass[final,authoryear,5p,times,twocolumn]{elsarticle}

%% if you use PostScript figures in your article
%% use the gra

%%graphis package for simple commands
%% \usepackage{graphics}
%\usepackage{cases}
%% or use the graphicx package for more complicated commands
\usepackage{graphicx}
%% or use the epsfig package if you prefer to use the old commands
\usepackage{epsfig}
%\usepackage{subfig}
\usepackage{comment}

\usepackage{epstopdf}
\usepackage{pdflscape}
\usepackage{bm}
\usepackage{hyperref,url}
\hypersetup{colorlinks=true, urlcolor=blue, linkcolor=blue, citecolor=red}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb,amsmath,array}
%The amsthm package provides extended theorem environments
\usepackage{amsthm}
\usepackage{graphicx}
%\usepackage{subfigure}
  
%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
%% \usepackage{lineno}

\usepackage{lscape}

%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon (default)
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   authoryear - selects author-year citations (default)
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%   longnamesfirst  -  makes first citation full author list
%%
%% \biboptions{longnamesfirst,comma}

% \biboptions{}

\newcommand{\JGnote}[1]{\fbox{\parbox{\textwidth}{ \color{red} JG Note $\Rightarrow$ #1}}}
\newcommand{\KCnote}[1]{\fbox{\parbox{\textwidth}{ \color{black} KC Note $\Rightarrow$ #1}}}
\newcommand{\red}{\textcolor{red}}
\newcommand{\blue}{\textcolor{blue}}
\newcommand{\green}{\textcolor{green}}
\journal{Advances in Water Resources}
\newcommand{\frc}{\displaystyle\frac}
\newcommand{\PN}[2][error]{P$_{#1}$DG-P$_{#2}$}
\newcommand{\PNDG}[2][error]{P$_{#1}$DG-P$_{#2}$DG}

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\title{ \blue{Numerical investigation of viscous flow instabilities through heterogeneous porous media using adaptive and unstructured meshes under different mobility scenarios - change the title to something close to the main topic of the manuscript ... something with viscous flow instability or viscous fingering)}}

%% use optional labels to link authors explicitly to addresses:
\author[UoA]{K. Christou} \author[UoA,UFRGS]{W.C. Rad\"unz}  \author[UoA]{B. Lashore} \author[UESC]{F.B.S. de Oliveira}
\author[UoA]{J.L.M.A. Gomes\corref{cor1}}\ead{jefferson.gomes@abdn.ac.uk}

\cortext[cor1]{Corresponding author.}
\address[UoA]{Environmental and Industrial Fluid Mechanics Group, School of Engineering, University of Aberdeen, UK}
\address[UFRGS]{Engineering School, Federal University of Rio Grande do Sul, Brazil}
\address[UESC]{Department of Exact and Technological Sciences, State University of Santa Cruz, Bahia, Brazil}

\begin{abstract} 
A set of simulations is presented so as to model the viscous fingering-flow instability using a novel method for modeling multi-phase flows in porous media. Starting from the Hele-Shaw experimental which is mathematically analogous to the two-dimensional flow in porous medium, test-cases of both homogenous and heterogeneous computational domains, under different conditions are listed. The development of finger structures is explained by taking into account different maps of permeabilities, mobility ratios and surface tension. A novel control finite element method (CVFEM) is used to discretize the governing equations that will solve the multi-fluid porous media flow model. The governing multiphase porous media flow equations are solved using an adaptive and unstructured mesh. In this paper the use of dynamic mesh adaptivity to capture the viscous fingering in reservoir flows is introduced, as one of the methods that will allow the user to focus the effort where is needed, minimizing both the CPU time and the numerical diffusion. It was found that the initial state is the decisive factor in the development of the process up to large times 
The aim of this paper is to extend and further apply the formulation (embedded in the Fluidity software framework) to multiphase flows in heterogeneous porous media combined with either uniform or random generated permeability distribution.
\end{abstract} 

\begin{keyword} %% keywords here, in the form: keyword \sep keyword
 Multi-fluid flows \sep Viscous Instabilities \sep Mobility Ratio \sep Porous media \sep Finite Element Methods.
\end{keyword}
 
\end{frontmatter}

%\tableofcontents
%\linenumbers

\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\section{Introduction}\label{section:intro}
\medskip
Numerical investigation of multiphase flows in porous media have attracted the attention of the scientific community over the past 40 years. Characterisation of fluid flow through porous media serves as the foundation of reservoir engineering and groundwater studies. %Oil and gas migration in reservoirs and transport of contaminants in groundwater are some of important physical problems in which porous media flows play a crucial role. 
%Reservoir engineers and hydro-geologists are dealing with complex geometries, irregular boundaries and heterogeneous geological formations.
Underground coal gasification is another important area of interest. More recently due to global environmental problems several research work have focused on CO$_{\text{2}}$ migration and trapping mechanisms in carbon capture utilisation and storage (CCUS) operations~\citep{spycher_2003, chen_2006, self_2012, pruess_1990c, white_1981,jiang_2011}.

Due to complex and/or heterogeneous geological formations, detailed modelling and simulation of multiphase flows through porous media is crucial to understand the aforementioned processes. Description of physics and mechanisms of multiphase flows were reported by \citet{wooding_1976} with focus on capillary pressure and the flow regimes in capillary media. A comprehensive review of mechanisms of fingering (i.e., fluid instability) and forces acting on the interface between two immiscible fluids can be found in \citet{homsy_1987}. \citet{adler_1988} described both microscopic and macroscopic scale darcy-equations. Immiscible displacements in porous media with both capillary and viscous effects can be characterized by two dimensionless numbers, the 
capillary number $C$ (macroscopic level), which is the ratio of viscous forces to capillary forces, and the ratio $M$ (or MR for both microscopic and macroscopic level) of the two viscosities. For certain values of these numbers, either viscous or capillary forces dominate leading to the following basic concepts, (a) viscous fingering (this will be described in the following sections), (b) capillary fingering or (c) stable displacement (cross flow with piston shape front characteristics).
%In a porous medium that is statistically homogenous two immiscible fluids are asumed to coexist together within a solid matrix. In a microscopic level fluids are newtonian and incompressible and gravity is the only external force acting on the system. An interfacial tension $\sigma$ is assumed to exist at the interfaces separating the two fluids. The main difference between microscopic and macroscopic level is the concept of capillary pressure. Nevertheless we should refer to the area of flow instabilities  as these, first described by \citet{saffman_1958} %\red{(IS THIS TRUE? SAFFMANN MAY HAVE BEEN THE FIRST TO THROUGHLY DISCUSS VISCOUS INSTABILITIES, BUT THERE WERE OTHER SCIENTISTS THAT DESCRIBED FLUID INSTABILITIES BEFORE, E.G., RAYLEIGH(1896), TAYLOR (1955) ETC)}.
A distinction should be made between microscopic and macroscopic instabilities. Microscopic instabilities describe phenomena occurring locally, for example, Kelvin-Helmholtz and Saffman-Taylor instabilities \citep{saffman_1959}. On the other hand, macroscopic instabilities involve two-phase flow system \citep{bottoni_1992}. This paper will focus on microscopic instabilities and phenomena in two-phase systems while a this work will focus on a local flow instability due to viscous and stress forces, often referred as viscous instability or \textit{viscous fingering}.
Due to complex and/or heterogeneous geological formations, detailed modelling and simulation of multiphase flows through porous media is crucial to understand the aforementioned processes. Description of physics and mechanisms of multiphase flows were reported by \citet{wooding_1976} with focus on capillary pressure and the flow regimes in capillary media. A comprehensive review of mechanisms of fingering (i.e., fluid instability) and forces acting on the interface between two immiscible fluids can be found in \citet{homsy_1987}. \citet{adler_1988} described both microscopic and macroscopic scale darcy-equations. Immiscible displacements in porous media with both capillary and viscous effects can be characterized by two dimensionless numbers, the 
capillary number $C$ (macroscopic level), which is the ratio of viscous forces to capillary forces, and the ratio $M$ (or MR for both microscopic and macroscopic level) of the two viscosities. For certain values of these numbers, either viscous or capillary forces dominate leading to the following basic concepts, (a) viscous fingering (this will be described in the following sections), (b) capillary fingering or (c) stable displacement (cross flow with piston shape front characteristics).
%In a porous medium that is statistically homogenous two immiscible fluids are asumed to coexist together within a solid matrix. In a microscopic level fluids are newtonian and incompressible and gravity is the only external force acting on the system. An interfacial tension $\sigma$ is assumed to exist at the interfaces separating the two fluids. The main difference between microscopic and macroscopic level is the concept of capillary pressure. Nevertheless we should refer to the area of flow instabilities  as these, first described by \citet{saffman_1958} %\red{(IS THIS TRUE? SAFFMANN MAY HAVE BEEN THE FIRST TO THROUGHLY DISCUSS VISCOUS INSTABILITIES, BUT THERE WERE OTHER SCIENTISTS THAT DESCRIBED FLUID INSTABILITIES BEFORE, E.G., RAYLEIGH(1896), TAYLOR (1955) ETC)}.
 A distinction should be made between microscopic and macroscopic instabilities. Microscopic instabilities describe phenomena occurring locally, for example, Kelvin-Helmholtz and Saffman-Taylor instabilities \citep{saffman_1959}. On the other hand, macroscopic instabilities involve two-phase flow system \citep{bottoni_1992}. This paper will focus on microscopic instabilities and phenomena in two-phase systems while a this work will focus on a local flow instability due to viscous and stress forces, often referred as viscous instability or \textit{viscous fingering}.
In oil and gas reservoir exploration, viscous and density instabilities are relatively common during water-injection processes. As water and oil interacts, the interface between these two fluids moves along the geological formation, creating an uneven or fingered flow profile (see Fig.~\ref{fig:simple_case}). Viscous fingering results in inefficient flow sweeping which can bypass significant quantities of recoverable oil and, may lead to early breakthrough of water into neighbour production wells. Viscous instabilities are mainly governed by the ratio of mobility (MR) between the displacing and the displaced fluids. Other conditions that may also influence the severity of viscous fingering are: heterogeneity (i.e., large spatial permeability gradient) , gravitational forces, anisotropic dispersion, velocity dependence of dispersion, non-monotonic viscosity profiles, etc.

\medskip 
Conservation of mass and Darcy's law are the governing equations that describe the flow dynamics in porous media. Several computational methods have been developed to accurately represent force balances in Darcean flows. Finite difference methods (FDM) have been extensively used in most industry-standard reservoir simulators~\citep{aziz_1986, chen_2005, chang_1990} with relative success in multi-physics single phase applications. However, FDM are often limited to relatively simple geometries representing idealised geological formations through structured quadilateral (2-D) and hexahedral (3-D) grid cells of low quality~\citep{mlacnik_2004, king_1999}. Additionally, FDM produce excessive numerical dispersion when heterogeneity (represented by permeability and porosity fields) is present~\citep{chavent_1986}.

The geometrical flexibility associated with high-order numerical accuracy of finite element methods (FEM) has proven to be more efficient than FDM schemes when they are used to solve complex geometries. FEM discretisation is based upon piecewise representation of the solution space and the computational domain is divided into smaller subdomains (elements) where the solution in each element is constructed from basis functions. %Advantages of FEM over FVM are the better description of the geometry and complex shapes, better treatment of fluid flow and more accurate field-solution calculations using a smaller number of nodes, less memory space and shorter run times. %At this point let us remind that a comparison of computaional methods is difficult and depends always on the test-case.
%The geometrical flexibility associated with high-order numerical accuracy of finite element methods (FEM) has proven to be more efficient compared with FDM schemes when they are used to solve complex geometrical domains. FEM discretization is based upon a piecewise representation of the solution in terms of specified basis functions. The computational domain is divided into smaller domains (elements) and the solution in each element is constructed from the basis functions. Advantages of FEM over FVM are the better description of the geometry and complex shapes, better treatment of fluid flow and more accurate field-solution calculations using a smaller number of nodes, less memory space and shorter run times. 

Among FEM-based formulations for porous media, the control volume finite element methods, ~\citep[CVFEM,][]{fung_1992} has been largely used as it can guarantee local mass conservation and high-order numerical accuracy as well as being able to use tetrahedral geometry-conforming elements. In standard CVFEM formulations, pressure and velocity are interpolated using piecewise linear finite element basis functions, %$\underline{\bf v}$ and $\underline{\bf p}$) 
while saturation is represented in node centered CV basis functions.  Saturation equations are solved explicitly after solving for pressure at each non-linear iteration~\citep[a detailed description of the implicit pressure explicit saturation, IMPES, formulation can be found in][]{chen_2006,lux_2012}.

%%%%%%%%%%%%%%%
%\begin{comment}
%\begin{equation}
% p^{n} = \sum_{j} \hat{p_{j}} N_{\alpha} 
%\label{cvfe_pressure}
%\end{equation}

%\begin{equation}
% S^{n} = \sum_{j} \hat{p_{j}} M_{b} 
%\label{cvfe_saturation}
%\end{equation}
%\end{comment}
%%%%%%%%%%%%%%%

\medskip
%Through the $P_{1}DGP_{2}$ element type, 
Material properties and flow conditions (e.g., density, temperature, species concentration etc) can be allocated in control volume space as shown in Fig.~\ref{fig:fem_cv}. %describes the $P_{1}DGP_{2}$ element type may vary abruptly (permeability and/or porosity contrasts at fracture-matrix interfaces). 
Since geometries are captured by finite elements, constructed control volumes typically extend on each side of the interface which may have different properties. Therefore, some average value of the permeability (defined in the FE space but projected into the CV space) is applied across the CVs at these interfaces. This often leads to excessive numerical dispersion especially in highly heterogeneous media. In order to overcome such artificial numerical dispersion, discontinuous hybrid finite element finite volume method (DFEFVM) was introduced by \citet{nick_2011b, nick_2011a}. This novel discretisation scheme was designed to simulate flows through discrete fractured rocks in which CVs are divided along the interfaces of different materials. \citet{cumming_2011} demonstrated that CVFEM discretisation could also be used to solve Richards' equations (coupled mass conservation and Darcy equation) in heterogeneous media with relatively small computational overhead~\citep[compared with traditional coupled velocity-pressure based formulations, see also][]{cumming_phd2012}. Fluxes over CV's were calculated based upon material properties, whereas the saturation fields were volume-averaged at the interface of the materials, enforcing mass balance as described by \citet{kirkland_1992}.

Through the $P_{1}DGP_{2}$ element type, material properties can be described using the control volume finite element methods (Fig.\ref{fig:fem_cv}. %describes the $P_{1}DGP_{2}$ element type may vary abruptly (permeability and/or porosity contrasts at fracture-matrix interfaces). 
Since geometries are captured by finite elements, constructed control volumes typically extend over the interfaces which may have different properties. Therefore, some average value of the permeability (defined in the FE space but projected into the CV space) is applied across the CVs at these interfaces. This often leads to excessive numerical dispersion especially in highly heterogeneous media. In order to overcome such artificial numerical dispersion, discontinuous hybrid finite element finite volume method (DFEFVM) was introduced by \citet{nick_2011b, nick_2011a}. This novel discretisation scheme was designed to simulate flows through discrete fractured rocks in which CVs are divided along the interfaces of different materials. \citet{cumming_2011} demonstrated that CVFEM discretisation could also be used to solve Richards' equations (coupled mass conservation and Darcy equation) in heterogeneous media with relatively small computational overhead~\citep[compared with traditional coupled velocity-pressure based formulations, see also][]{cumming_phd2012}. Fluxes over CV's were calculated based upon material properties, whereas the saturation fields were volume-averaged at the interface of the materials, enforcing mass balance as described by \citet{kirkland_1992}.

%The conservation of mass along with Darcy's law are the governing equations while variables such as pressure, velocity,saturation and permeability define the behaviour of the flow. Finite difference methods have been applied to discretise the governing equations \citep{Luo2016,Moortgat2016,Hoteit2008} .
%\KCnote{in our case only - In conventional reservoirs the principal forces that affect fluid flow include, viscous forces, effects of gravity and permeability diffrences while in unconventional gas reservoirs flow simulation models take into account the phenomena of adsorption and diffusion \citep{abdus_2015}. Even though the mechanisms of the instabilities may vary, however it is still a function of relative mobility, gravity, viscous forces and permeability differences. All these parameters are represented under one term in the global mass balance equation.}

\medskip
The objective of this study is to investigate and describe the behaviour of viscous fingering through a novel CVFEM formulation that exploits adaptive mesh of fully-unstructured triangle and tetrahedron grids. Also two key characteristics that describe the research concept are: (a) the hybrid element pair $P_{n}DGP_{m}$ which provides discontinuous and piecewise representation for velocity and continuous and piecewise representation of pressure at FE space and (b) dual representation of pressure and velocity fields in the FE and CV spaces.
The objective of this study is to investigate and describe the behaviour of viscous fingering through a novel CVFE formulation that exploits adaptive mesh of fully triangle and tetrahedron grids. Also two key characteristics that describe the research concept above are: (a) the hybrid element pair $P_{n}DGP_{m}$ which provides discontinuous and piecewise representation for velocity and continuous and piecewise representation of pressure at FE space and (b) a dual representation of pressure and velocity fields in teh FE and CV spaces.

\medskip
In the next sections the numerical formulation and a summary of the main governing equations for multiphase compositional flows will discussed. The remainder of the paper will include a description of the viscous fingering along with the finite element method technique, a discussion of the test-cases and the simulation results and the key conclusions. The analysis will consider ($1$)permeability heterogeities, ($2$)capturing the development of the interface and the evolution of fingers, ($3$)test-case comparison, but for now will neglect any gravitational effects.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Governing equations and numerical scheme}\label{equations_scheme}      
%Multiphase flow in porous media is described by mass conversation and Darcy equations for all the phase $\alpha$ ($\alpha$ = g, o, w, for gas, oil, and water phases). Different domains will produce different flow instabilities. In this paper, the test-cases are based on the discontinuous Galerkin (DG) method. DG-methods combine advantages of classical finite volume and finite element methods.  

%\subsection{Numerical Formulation}
%%%%%%%%%%%%%%%
%\begin{comment}
%Flows in porous media are expressed by the Darcy's law and the saturation equation. At this stage the control volume finite element method is used (CVFEM). Darcy's law for immiscible multi-phase flow may be written in the form:
%\begin{equation}\label{e:darcy_eq}
%  \mathbf{q}_{\alpha} = -\frac{\mathcal{K}_{{r}_\alpha}\mathbf{K}}{\mu_{\alpha}}\left(\nabla p_{\alpha} - {\mathbf{s}_{u}}_{\alpha} \right),
%\end{equation}
%where $\mathbf{q}_{\alpha}$ is the $\alpha$-th phase Darcy velocity, $\mathbf{K}$ is the absolute permeability tensor of the porous medium, $\mathcal{K}_{{r}_\alpha}\left(S_{\alpha}\right)$ is the phase relative permeability, which is a function of the phase saturation $S_{\alpha}\left(\mathbf{r},t\right)$. $\mu_{\alpha}$, $p_{\alpha}$, $\rho_{\alpha}$, and $\mathbf{s}_{{u}_\alpha}$ are the phase dynamic viscosity, pressure, density and source term, which may include gravity and/or capillarity, respectively. 

%Substituting the saturation-weighted Darcy velocity by $\mathbf{u}_\alpha= \mathbf{q}_\alpha/S_\alpha$, then Eqn.~\ref{e:darcy_eq} may be rewritten as:
%\begin{equation}
%  \mathbf{v}_\alpha={\underline {\underline \sigma}}_{\alpha} \mathbf{u}_{\alpha} = - \nabla p_{\alpha} + {\mathbf{s}_{u}}_{\alpha},
%  \label{e:force_bal}
%\end{equation}
%where ${\underline {\underline \sigma}}_{\alpha}=\mu_\alpha S_\alpha \left(\mathcal{K}_{{r}_\alpha}\mathbf{K}\right)^{-1}$ represents the implicit linearisation of the viscous frictional forces. The force per unit volume $\mathbf{v}_\alpha$, defined as ${\underline {\underline \sigma}}_{\alpha} \mathbf{u}_\alpha$, is used as a prognostic variable in this approach \citep{pavlidis_2014}.

%\noindent In matrix form, Eq.~\ref{e:force_bal} is: %~\ref{force-semi-disc} is: 
%\begin{equation}
%  {\mathbf M} \underline {\mathbf v} = -{\mathbf C} \underline{\mathbf p} + \underline {\mathbf s}_{u}, \label{force-balance-matrix-form}
%\end{equation}
%where $\underline{\bf v}$ and $\underline{\bf p}$ solution-vectors (also known as shape functions) are defined as:
%\begin{eqnarray}
%    &&\underline{{\bf v}} = \left( \left( {v_x},{v_y},{v_z} \right)_{1,1}, \left( {v_x},{v_y},{v_z} \right)  _{2,1},\ldots, \left( {v_x},{v_y},{v_z} \right)_{\mathcal{N}_\alpha,\mathcal{N}_u} \right)^{T} \;\text{and} \nonumber \\ 
%    && \underline{{\bf p}} = \left(p_1, p_2, p_3, \cdots, p_{\mathcal{N}_p}\right)^T. \nonumber% \nonumber
%\label{v_and_p}
%\end{eqnarray}

%The saturations are computed in CV space, whereas the permeability tensor $\left(\mathbf{K}\right)$ is assumed piece-wise constant in FE space. Thus the viscous-friction damping tensor $ {\underline {\underline \sigma}}_{\alpha}$ is piece-wise constant within the sub-control volumes defined through intersections between the elements and control volumes.
%Introducing a saturation-weighted Darcy velocity defined as $\mathbf{u}_\alpha= \mathbf{q}_\alpha/S_\alpha$, then Eqn.~\ref{e:darcy_eq} may be rewritten as:
%\begin{equation}
%  \mathbf{v}_\alpha={\underline {\underline \sigma}}_{\alpha} \mathbf{u}_{\alpha} = - \nabla p_{\alpha} + {\mathbf{s}_{u}}_{\alpha},
%  \label{e:force_balance}
%\end{equation}

%\noindent The ${\underline {\underline \sigma}}_{\alpha}=\mu_\alpha S_\alpha \left(\mathcal{K}_{{r}_\alpha}\mathbf{K}\right)^{-1}$ represents the implicit linearisation of the viscous frictional forces. Assuming a porous media domain $\Omega\subset\mathcal{R}^{n}$ ($n$ is the number of dimensions). 
%\end{comment}

%%%%%%%%%%%%%%%
%\begin{comment}
%The displacing and displaced fluids are considered to be incompressible and immiscible under isothermal and no source or sink conditions. In addition, we neglect the effects of capillarity and gravity in our simulations. Therefore the governing equations of conservation of mass and Darcy's law can be described below as, 

%\begin{equation}
%  \mathbf{q}_{\alpha} = -\frac{\mathcal{K}_{{r}_\alpha}\mathbf{K}}{\mu_{\alpha}}\left(\nabla p_{\alpha} - {\mathbf{s}_{u}}_{\alpha} \right),
%\label{e:darcy_eq}
%\end{equation}
%where $\mathbf{q}_{\alpha}$ is the $\alpha$-th phase Darcy velocity, $\mathbf{K}$ is the absolute permeability tensor of the porous medium, $\mathcal{K}_{{r}_\alpha}\left(S_{\alpha}\right)$ is the phase relative permeability, which is a function of the phase saturation $S_{\alpha}\left(\mathbf{r},t\right)$. $\mu_{\alpha}$, $p_{\alpha}$, $\rho_{\alpha}$, and $\mathbf{s}_{{u}_\alpha}$ are the phase dynamic viscosity, pressure, density and source term, which may include gravity and/or capillarity, respectively.

%\begin{equation}
%  \mathbf{q}_{\alpha} = -\frac{\mathcal{K}_{{r}_\alpha}\left(S_{\alpha}\right)\mathbf{K}}{\mu_{\alpha}}\left( \nabla p_{\alpha} - {\mathbf{s}_{u}}_{\alpha} \right),
%S_{k}\left(\lambda_{k}\mathcal{K}\right)^{-1}\phi v_{\alpha} = \underline{\underline{\sigma}}_{\alpha} {\bf u}_{\alpha} = -\nabla p + \mathcal{S}_{u},
%\label{E:darcy_eqn}
%\end{equation}
%where $\mathbf{q}_{\alpha}$ is the $k\left(\in\left\{1,N_{p}\right\}\right)$-phase Darcy flow rate. $S$, $\mathbf{K}$, $\mathcal{K}_{r\alpha}\left(S_{\alpha}\right)$ and $\mu$ are saturation, absolute permeability tensor, phase relative permeability and viscosity, respectively. $s_{u}$ is a source term (e.g., gravity force) associated with the force balance and $p$ is the pressure.

% Defining the advective velocity averaged over the entire domain -- $\mathbf{u}_{\alpha}= \mathbf{q}_{\alpha}/S_{\alpha}$, then we may rewrite Eq.(\ref{E:darcy_ext}),
%\begin{equation}
%  {\underline {\underline \sigma}}_{\alpha} \mathbf{u}_{\alpha} = - \nabla p + {\mathbf{s}_{u}}_{\alpha},
%  \label{e:darcy_ext}
%\end{equation}
%$\underline{\underline{\sigma}}_{\alpha}=\mu_{\alpha}S_{\alpha}\left(\mathcal{K}_{r\alpha}\mathbf{K}\right)^{-1}$ represents the implicit linearisation of the viscous frictional forces, and is piecewise constant within each FE and is obtained via basis functions local to each CV within each element \citep{Jackson13,Radunz14}.
%\end{comment}
%%%%%%%%%%%%%%%

\medskip
The two-phase flow through the porous media domain $\Omega$, may be described by the coupled extended Darcy and global mass conservation equations,
\begin{eqnarray}
\left(\displaystyle\frac{\mu_{\alpha}S_{\alpha}}{{\mathbf K}\mathcal{K}_{r\alpha}}\right) {\mathbf u}_{\alpha} = \underline{\underline{\sigma}}_{\alpha} {\mathbf u}_{\alpha} = -\nabla p + \mathcal{S}_{u,\alpha},\;\;\; x_{i}\in\Omega, t>0 \label{eqn:darcy_eqn} \\
\phi\displaystyle\frac{\partial S_{\alpha} }{\partial t} +   \nabla \cdot \left( {\mathbf u}_{\alpha}  S_{\alpha}\right) =  \mathcal{S}_{cty,\alpha},\;\;\; x_{i}\in\Omega, t>0\label{eqn:saturation_eqn}
\end{eqnarray}
where, $\mu$, ${\bf K}$, $p$ and $\phi$ are the viscosity, absolute permeability, pressure and porosity, respectively. ${\mathbf u}_{\alpha}$ is the saturation-weighted Darcy velocity of the $\alpha$-phase and $\mathcal{K}_{r,\alpha}$ is the relative permeability. $\mathcal{S}$ is the source term associated with the Darcy and continuity equations. $S_{\alpha}$ is saturation of the $\alpha$-phase with the constraint of $\sum\limits_{\alpha=1}^{\mathcal{N}_{p}} S_{\alpha} = 1$, where $\mathcal{N}_{p}$ denotes the number of phases.

%%%%%%%%%%%%%%%
%\begin{comment}
%The main equations that will be used along with the following OCVFEM techique can be summarised below. The global mass balance equation and force balance equation are solving by vanishing the velocity term and solving the system of equations for pressure. At the $n+1$ step those two equations mentioned above can be rewritten as,

%\begin{equation}
%M_{\sigma} {{\underline{u}}^{n+1}} = C {\underline{p}^{n+1}} + {\underline{s}_u ^{n+1}}
%\label{e:mass_bal}
%\end{equation}

%\begin{equation}
%B^T {{\underline{u}}^{n+1}} = {\underline{s}_p ^{n+1}}
%\label{e:force_bal}
%\end{equation}

%\noindent Application of a discontinuous FEM for velocity leads to a block-diagonal $M_{\sigma}$ matrix that can be readily inverted, each block being local to an element. This system of equations can be rewritten to produce the pressure equation, 

%\begin{equation}
%B^T M_{\sigma} ^{-1} C{{\underline{p}}^{n+1}} = {\underline{s}_p ^{n+1}} - B^T M_{\sigma} ^{-1} {{\underline{s}}^{n+1}} 
%\label{e:pressure_eq}
%\end{equation}

%\end{comment}
%%%%%%%%%%%%%%%

\medskip
Finite element basis functions for velocity and pressure fields are introduced in the discretisation of force-balance equation %(Eqn.~\ref{e:darcy_eq}). 
Hybrid basis functions are also developed to allow CV-based velocity to be extrapolated across the entire element. $\underline{\underline{\sigma}}_{k}=\underline{\underline{\sigma}}_{k}\left({\mathbf K}, \mathcal{K}_{rk}, S_{K}, \mu_{k}\right)$ is an absorption-like term that lies in both CV and FEM spaces. Though, whilst the saturation field is calculated in CV space, permeability $\left({\mathbf K}\right)$ is piecewise constant in FE space to allow efficient representation of surface parametrised geometries. The global saturation equation (Eqn.~\ref{eqn:saturation_eqn}) is discretised in space with CV basis function and with the $\theta$-method in time as described by \citet{gomes_book_2012}. Velocities across CV interfaces (within and between elements, see Fig.\ref{fig:fem_cv} below) are calculated through a directional-weighted flux-limited scheme based on upwind value of $\sigma$ at individual CV as described by \citet{jackson_2013}.

\medskip
The method developed is applicable to $\mathcal{N_{p}}$ fluid phases and is based on the novel family of $P_{n}(DG)-P_{m}(DG)$ element-pair consistent with the dual pressure-velocity representation in control volume (CV) and finite element (FE) spaces. These element-pairs have a discontinuous $n^{th}$-order polynomial representation for velocity and a discontinuous $m^{th}$-order polynomial for pressure. Another element pair, that can be used is the $P_{n}DGP_{m}$ with an $m^{th}$-order continuous representation for pressure. The mass balance (continuity) equations are solved in CV space and a Petrov-Galerkin finite element (FE) method is used to obtain the high-order fluxes on CV boundaries (Fig.\ref{fig:fem_elem}), which are limited to yield bounded fields.
Saturation, and all saturation-dependent material properties such as relative permeability and capillary pressure, are represented CV-wise. The pressure, a key difference to other CVFE methods reported previously, allows the use of CVs that do not span multiple FEs. Hence each CV (and FE) is associated with a unique set of petrophysical properties, in contrast to most previous methods in which CVs span multiple values of petrophysical properties described FE-wise. In this model we assume that rock and fluids are incompressible thus the mass ballance for phase $\alpha$ can be written as (Eq.\ref{mass_balance})

\begin{equation}
\phi \; \frac{\partial S_{\alpha}}{\partial t} + \nabla (u_{\alpha}S_{\alpha})= \mathcal{S}_{cty,\alpha}
\label{mass_balance}
\end{equation}
 
%\noindent where $\phi$ represents the porosity, S represents the saturation and v is the saturation weighted Darcy velocity (such that $v_{\alpha}S_{\alpha}$ is the traditional Darcy velocity of phase p), and q is a volume source term, subject to the contrains on the saturation

%\begin{equation}
%\sum  S_{p}-1
%\label{saturation_constrain}
%\end{equation}

Equation \ref{mass_balance} is discretized in time and space using the $\theta$-method %\citep{saramito_1994}. 
Summing over all phases yields the global mass balance equation %\ref{global_mass_balance},

\begin{eqnarray}
 && \sum_{\alpha=1}^{N_{p}} \int\limits_{\Omega_{CVi}} \; M_{i} \; \frac{\phi\left(S_{\alpha i}^{n+1}\right)-\left(S_{\alpha i}^{n}\right)}{\Delta t} dV  + \nonumber\\
 &&  \oint_{\Gamma_{CVi}} [\; \theta^{n+1/2}\; {\mathbf n}\dot \; {\mathbf u}_{\alpha}^{n+1}S_{\alpha}^{n+1} \; + \; (1-\theta^{n+1/2}) \; {\mathbf u}_{\alpha}^{n}S_{\alpha}^{n}] d\Gamma \;- \nonumber\\
 &&  \int_{\Omega_{CVi}} M_{i} \; \mathcal{S}_{cty,\alpha}^{n+\theta} \; dV\; =0
\label{global_mass_balance}
\end{eqnarray}

\noindent where $\Omega_{CVi}$ and $\Gamma_{CVi}$ are the volume and boundary of CV i respectively, \textbf{n} is the outward pointing unit normal vector to the surface of $CV_{i}$ and $\theta$ varies smoothly between $0.5$ (corresponding to Crank-Nicolson method) and $1$ (corresponding to backward-Euler scheme) to avoid the introduction of spurious oscillations for large grid Courant numbers. In addition to the numerical schemes above the discretised global mass and force balance equations are solved using a multigrid-like approach, see \citet{pavlidis2016}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\section{Brief Overview of Viscous Instabilities}\label{section:ViscousInstabilities}
\medskip
As in many areas of fluid mechanics, the behaviour of the flow for conditions that exceed critical limits may cause instabilities in the system. The flow of a fluid over or next to another heavier fluid, can produce flow instabilities. Under this assumption when a fluid is injected in a porous domain saturated with another fluid trying to displace it, viscous fingering will occur, as viscous driven hydrodynamic instability leads to the collapse of the uniform interface between fluids of different viscosity. This type of instability can be found across many research areas, disciplines and scales, from small chemical and medical separation systems to large scale field geological and /or reservoir systems. Starting from the work of \citet{muskat_1934} and later from \citet{saffman_1959} and \citet{homsy_1987}, the experimental setup of Hele-Shaw cell by \citet{saffman_1986}, and the basic mathematical model has been initially developed to describe the physics of this phenomenon. The idea is to introduce a fluid between two parallel flat plates separated by an infinitesimally small gap. The governing equation of Hele-Shaw flows is identical to that of the inviscid potential flow and to the flow of fluid through a porous medium (Darcy's law). More recently work that has been done by \citet{howison_2000} and \citet{praud_2005} give an extensive description on the mathematical background of the Saffman $\&$ Taylor problem (also know as immiscible two-phase flow in Hele-Shaw cell). 

\medskip
In viscous fingering, a less viscous fluid pushes a more viscous fluid, in a thin rectangular cell (known as Hele-Shaw cell). \citet{howison_2000}  Under the assumption that fluids remain immiscible along an interface, surface tension plays an important role in determining the shape and progress of the fingers. For homogeneous domains fingers will start to develop when surface tension acting on the interface, is opposing towards the change of shape of the interface thus the interface becomes unstable and will collapse, taking a curved shape. In heterogeneous environments this process may also be triggered by permeability differences between smaller regions. The higher the velocity of the injected fluid, the less wide (tip-splitting behaviour) the finger will be. In addition, pressure differences %(eq.\ref{eq:pressure_dif}) 
acting on the interface will produce a net pressure force,  

\begin{equation}
\Delta P= - \gamma \; \nabla \; \dot \; \hat{n} 
\label{eq:pressure_dif} 
\end{equation}

\noindent this is also know as the Young-Laplace equation, a relation describing the capillary pressure difference across the interface between two fluids. With $\Delta P$ denoting the pressure difference, $\hat{n}$ the unit normal vector out of the surface, and $\gamma$ the surface tension. As mentioned in Section \ref{section:intro}, an unfavourable mobility-ratio in a water-oil system will have the following definition, see eqn.\ref{eq:MR}.

\begin{equation}
 MR \; = \frac{k_{rw} \; \mu_{w}}{k_{ro} \; \mu_{o}} 
\label{eq:MR}
\end{equation}

\noindent Fingering will occur in immiscible displacements when the viscocity ratio is greater than unity. %As surface tension becomes weak, the front of the steady finger is susceptible to a viscous-fingering instability by the basic mechanism associated with a less viscous fluid displacing a more viscous one. After a split, each of the new lobes of the finger is stable as a result of their being thinner than the finger from which they split. 
As surface tension becomes weak, the front is stressed and goes under a viscous-fingering instability. The front will collapse and will start splitting into new lobes of fingers. One of these fingers will eventually outgrow the others and will then spread to occupy the appropriate width of the cell. In the process, it reaches a width that is again unstable to splitting, and the pattern repeats. Thus, surface tension plays an essential dual role; it must be weak enough for the tip front to be unstable, but it is also the physical force causing the \textit{spreading} and ensuing repeated branching.

In  this paper, viscous instabilities for different test-cases will be investigated. Adaptive and unstructured mesh will be used to capture the collapse of the interface and the development of the fingers in relation to different values of mobility ratios and different maps of permeabilities. Initially test-cases that verify the existence of fingers in experimental domains will illustrated follow by more complicated computational domains and finger patterns.  

%%%%%%%%%%%%%%%
%\begin{comment}
%Important parameter is the mobility (or viscosity) ratio. This is given by Eq.~\ref{eq:mobility-of-fluid} where $K$ is absolute permeability and $k_{r}$ is relative permeability :

%\begin{equation}
%\lambda = \frac{K\;k_{\alpha}}{\mu}
%\label{eq:mobility-of-fluid}
%\end{equation}

%\noindent Regarding the mechanics, lets assume a porous medium, characterized by a constant permeability $K$. The flow will typically involve the displacement of a fluid of viscosity $\mu_1$  and density $\rho_1$ by a second of viscosity $\mu_2$ and density $\rho_2$. Under suitable continuum assumptions, Darcy's law, is used to describe the flow through a porous medium.

%\begin{equation}
%U = \frac{b^2}{12 \mu} \nabla p
%\end{equation}

%and the above equation can be re-arranged for 1D steady flow as,

%\begin{equation}
%\frac{dp}{dx}= - \frac{\mu U}{K} + \rho g
%\label{eq:pressure_dif} 
%\end{equation}

%where, \textit{U}, is the velocity of the more viscous fluid, \textit{b}, is the cell gap (referring to Hele-Shaw cell) and \textit{$\nabla p$} is the pressure gradient. Now consider a sharp interface or zone where density, viscosity, and solute concentration all change rapidly. Then the pressure force $(\rho_2-\rho_1)$ on the displaced fluid as a result of a virtual displacement $\delta_x$ of the interface from its simple convected location is 

%\begin{equation}
%\delta\rho=(\rho_2-\rho_1)=[[\frac{(\mu_1-\mu_2)U}{\kappa}]+(\rho_2-\rho_1)g] \delta\chi
%\end{equation}

%If the net pressure force is positive, then any small displacement will amplify, leading to an instability.In this case gravity is a stabilizing force while viscosity is destabilizing leading to critical velocity $U_c$ above which there is an instability.

%\begin{equation}
%U_c = \frac{(\rho_1-\rho_2) \cdot g \cdot K}{(\mu_1-\mu_2)}
%\end{equation}
%\end{comment}
%%%%%%%%%%%%%%%

 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%% \section{}
%% \label{}

\pagebreak
\clearpage

%\listoftables
%\pagebreak
%\input{Manuscript_Table}

\pagebreak
\clearpage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results}\label{section:results}

%%%%%%%%%%%%
\subsection{Model Validation}

The set of test-cases that we are going to illustrate starts with an elementary case in a homogeneous domain. The aim of this test-case is to validate the different simulation/scenarios i.e., cross flow in a porous formation, evolution of fingers based on experimental Hele-Shaw work, behaviour of two-phase flow in more complicated formations and how factors like mobility ratio and heterogenities of the formations may affect the finger pattern. 

Fig.\ref{fig:simple_case} describes the starting point of the simulations that will follow. Fluid $1$ is from the left hand side of the formation. Later, different mobility ratios and different regions of various permeabilities will be introduced, but for now only few of these initial and boundary conditions will be applied. Boundary conditions will include a no-slip condition for the upper and lower boundary inlet is place at the left hand side while outlet on th right hand side of the domain. Initial conditions include initial values of velocity and pressure in the left and right hand side of the domain respectively. Also for different cases we have different geometrical domain aspect ratios, number of elements and types of grid (fixed and usntructured or adaptive and unstructured mesh). 

%\noindent One more case to demonstrate the model validation against experiments is described in fig. \ref{fig:square}.
\noindent A square domain consisting of $4$ square regions in which each quarter is represented by a permeability value (Fig.\ref{fig:square}a) and $1$ value of different permeabilities (K is represented by the blue and red shaded square areas) as well as it is fully saturated with fluid $2$. At the upper and lower sides of the domain no-slip boundary condition is applied. The left hand side of the domain is defined as the inlet for fluid $1$ which is introduced along this side with a velocity of $u=1$. The right hand side is the outlet and pressure is set to $0$. Fluid $1$ across the left hand side of the domain is trying to displace the existing fluid $2$. What can been seen here is a cross flow case as the flow passes through different regions and evolves. The front start to collapse at the first half of the lenght D (D:distance) of the domain ($x= \frac{1}{2} D)$ (Fig.\ref{fig:square}b).

\noindent In this test-case above the two phase volume volume fractions have the same but opposite behaviours across the length of the formation. The velocity magnitute is built up starting from the inlet all the way to the middle of the square. There is a sharp pressure drop which is also an indication that the fluid $2$ cannot be displaced any further (see Fig.\ref{fig:square}) while the phase volume fraction is constant. 

\medskip
A slightly modified test-case (see Fig.\ref{fig:testcase}) with similar initial and boundary conditions, but in this set of simulations the geometrical aspect ration is $2$. The model was also qualitatively validated against laboratory experiments conducted by \citet{evans_1994}. The last set of simulations as this is described in Fig.\ref{fig:1testcase} is and extension of the previous case and the aim of is to verify the behaviour of the flow for two different mobility ratios of $1$ and $10$ respectively.

\medskip
In this section three different sets of simulations were explained. Starting from an initial square set-up to validate the existance of cross flow and how the simulator works, we moved to a larger domain by increasing the aspect ratio. The reason was to give more time, space and greater number of elements to our simulator and again see how the front/cross-flow will develop. The third test-case is based in the initial and boundary condition of the second set of simulations. Now we would like to know what is the impact of different mobility ratios (see Fig.\ref{fig:6a},\ref{fig:6b},\ref{fig:6c}) and how the cross-flow as well as the simulation will progress on time. The purpose of these three cases was to verify that our model is working for cross flow cases thus will allow to proceed further and expand this technique into more complex formations. 


%%%%%%%%%%%%
\subsection{Hele-Shaw validation cases for homogeneous and heterogeneous domains under two different mobility ratios}

\medskip
Based on the work of \citet{saffman_1986}, the Hele-shaw cell, a geometrical domain as this is defined by experimental studies and is presented in Figures \ref{fig:1a_homoheleshaw_3},\ref{fig:1b_homoheleshaw_3} and Fig.\ref{fig:1c_homoheleshaw_3} will be used for the next set of simulations. In all cases, simulations were performed in a squared geometry of $5\times5$, where fluid $1$ is added into the domain at the bottom left-hand side corner with a velocity (magnitude) of 0.7071 %(i.e., sqrt(2*0.25))
. The sink (pressure set to $0$) is allocated in the top right hand side corner of the domain. Newmann boundary conditions %(i.e., no flux) 
was imposed to all borders of the domain except at the top righ hand side corner. The mobility ratios for these $3$ cases are $3$ and $10$ while for the latter, homogeneous and heterogeneous domain is used.

\medskip
In Fig.\ref{fig:1a_homoheleshaw_3}(a), there is the description of the domain. Three different cases with different set-ups will follow. The first one is the homogeneous domain where permeability $K_{1}=1.e-10$ everywhere while for the heterogeneous case the following permeabilities have been introduced, $K_{1}=(1.e-10 \;to\; 5.e-10$), $K_{2}=1.e-10$, $K_{3}=(1.e-11 \;to\; 5.e-10)$ and $K_{4}=(1.e-12 \;to\; 5.e-10)$. For the homogeneous case we use two different mobility ratios of $3$ and $10$ while we proceed to the heterogenous case using a mobility ratio of $10$. 

\medskip
As can been seen from the Fig.\ref{fig:1a_homoheleshaw_3},\ref{fig:1b_homoheleshaw_3} and Fig.\ref{fig:1c_homoheleshaw_3} there is a significant difference on the flow pattern when the mobility ratio is $3$ and when it is $10$ under the same number of elements. Figures \ref{fig:1a_homoheleshaw_3}, \ref{fig:1b_homoheleshaw_3}, \ref{fig:1c_homoheleshaw_3} give a description of the Hele-Shaw cell simulation when $MR=10$ followed by the same initial and boundary conditions set-up, but now for the Hele-Shaw case of a heterogeneous formation as this is described in Figures \ref{fig:3a_heteheleshaw_10},\ref{fig:3b_heteheleshaw_10},\ref{fig:3c_heteheleshaw_10}. Fingers will be more profound and will start develop faster when the $MR=10$ compared to the uniform front that is developing when the $MR=3$ for the same time steps. In addition the flow patter of the fingers will be sharper and more intense when different regions with different permeabilities are introduced in the formation. The importance of this set-up is to understand how the simulation works and if the result that will produced reagarding the development and pattern of the fingers, actually follow the experimental results  and how this is developed under different permeability schemes as these has already been experimentaly tested.  


%%%%%%%%%%%%%
\subsection{Comparison of fixed and adaptive mesh under heterogeneous domain schemes and the same mobility ratio.}

\medskip
Having already verified that model is working for the hele-shaw experimental test-cases, now a more complicated case will be introduced with regions of different geometrical domains and different permeabilities. Initial and boundary conditions are described in Fig. \ref{fig:testcase_heter_domain}, while inlet velocity is $u=1$ on the left hand side and the pressure set to $0$ on the outlet. A quick reminder at this point is that the simulator we are testing has also options to introduce gravity and/or corriolis, but for this current set of simulations these are neglected. What is expected is a significant growth of fingers when comparing mobility ratios that differ an order of magnitude (Fig.\ref{fig:1testcase}). The next step is a comparison under the same mobility ratio of $10$, using the fixed and the adaptive mesh. For the fixed mesh we have $4600$ elements, but for the adaptive mesh we start with $400$ up to $600$, depends how fine we would like the mesh to be, and we reach up to $24000$. %Figure \ref{fig:testcase_heter_domain} gives a description of the domain that will be used. 
Figures \ref{fig:2testcase_a}, \ref{fig:2testcase_b}, \ref{fig:2testcase_c} and \ref{fig:2testcase_d} will give a description of the simulation for different time-steps as these are described. In this set the interfacial instability is becoming more profound as the flow develops. Based on these two cases so far, an initial relation between the quantitative and qualitative outcome of our simulations can be derived. Fingers will develop faster in areas where permeabilities are higher. This can be seen from the overall sharp increase of velocity magnitude during the injection of the fluid $1$.    


\subsection{Comparison of flow pattern with a different simulation set-up with and an additional inlet region.}

\medskip
Figure \ref{fig:3testcase_a} illustrates another set of simulations for when another region (inlet) of fluid $1$ ins introduced into the formation. This time fluid $1$ is injected from both the left hand side and the upper left corner of the domain, at a velocity u=$0.5$ while the set up of the problem remains the same, the mobility ratio is $10$, and the adaptive and ustructured mesh is implied. The top layer is saturated with phase $2$, while the rest of the domain has a saturation of $0.1$. The major difference is located in the velocity fields (see Fig.\ref{fig:vel_magn2}) as the presence of this extra inlet increases the flow at the top layers. At this point is proper to mentioned the extreme case, see Fig.\ref{fig:4testcase}, when mobility ratio is even an order of magnitude higher, when MR=$100$. Even though a this case is unlikely to happen as the mobility ration of the existing fluids in the industry, it is a test-case that can illustrate the higher, faster and more profound development of instabilities. Also by focusing the grid resolution in the saturation front, \citet{christou_2015}  demonstrated the explicit formation of fingers formed due to the instability in the pressure eld and triggered by viscosity ratio. A comparison has also been made by using a low resolution element, the $P_{1}DG-P_{1}DG$. No fingers could be observed due to mesh coarseness (fingers were observed in ner uniform and adaptive meshes).

The last case that will give an estimable and quantitative description to the reader is the when the mobility ration is highly increased into $100$. Screenshots of the phase volume fraction and the development of fingers will are shown in fig.\ref{fig:4testcase}.


\medskip
The first example is a simple comparison between two cases using fixed mesh and mobility ratios of $1$ and $10$ respectively. 
%The aspect ratio of the $2D$ domain is 2 and it favors viscous fingering effects while temperature is not taken into account (assume isothermal environment) and gravity effects are negligible. 
Fluid $1$ is initially injected from the left hand side with velocity $u_{inj}=1$. The domain is fully saturated with fluid $2$. At the outlet (right hand side) boundary pressure levels are set to zero while no slip boundary conditions are implied at the upper and lower part of the formation. Fixed time step sizes of $1 \times 10^{-3}$ for both the fixed meshes and the CFL number for this set of simulations is $0.5$. The $P_{1}DGP_{2}$ element type with piecewise linear description of veleocity within each element and quadratic pressure representation as part of the OCVFEM method along with the discontinuous Galerkin method are implied and composing the mesh. Saturation is located at the pressure nodes. Five different regions of 5 distinct absolute permeabilities (K) are introduced (fig.\ref{fig:5regions_domain}). The red square region is saturated with a $50\%-50\%$ mixture of both phase $1$ and $2$. 

Two general behaviors for the interface may occur: (i) If a more viscous fluid displaces a less viscous one or a less viscous displaces a more viscous with a low average velocity, the interface is flat; (ii) if a less viscous fluid displaces a more viscous one with intermediate values of the average velocity, single or multiple fingers will be observed.

This test-case serves as a base case for comparison between mobility (or viscocity) ratios that differ by an order of magnitude. Viscocity is a measure of resistance, therefore a frictional property. In these test-cases the $\sigma$ term as this is described above contains the individual parameters related with wettability and contact angle while the porous surface is a fluid $2$ wetted surface. For mobility ratios below $5$ the injection front will uniformly develop as time progress (piston shape front) and no fingers are expexted. Instabilities will start to occur and will be more obvious for mobility ratios higher than $5$. Between two layers or two regions with different permeabilities, but both saturated with fluid $2$, fingers will be triggered because of the permeability differences on the interface of these layers. In between the porous cappilary pressure difference with curve the interface and will lead to the formation of fingers. In macroscopic scale the interface between the two fluid will become unstable, an uneven or fingered profile will be controlled by capilary pressure -acting in the scale of the pores- and therefore due to the overall surface tension difference between the two immiscible fluids the front will collapse. This is of major practical importance in the petroleum industry, environmental waste remediation, and subsurface hydrology and it is key to understanding the movement of large volumes of injection fluids into subsurface reservoirs. The relationships between the capillarity of a geologic system, and the saturation and permeability of the fluids has a direct bearing on the migration speed and reservoir sweep of hydrocarbons affected the productivity of an oil field.


\medskip
The macroscopic sweep efficiency is principally affected by the heterogeneity in the reservoir which controls the spatial distribution of porosity and permeability. The permeability depends on the number, size and connectivity of the pores. This set of parameters is described by the $\sigma$ in the global mass balance equation (eq.\ref{global_mass_balance}). Including higher permeability zones also know as higher permeability channels or layers in the set up of the model, allows our test-cases to give a good approximation of the so called "thief zones", something that is common in heterogeneous geological formations.

\medskip 
As can been seen so far in all the test-case illustrated, main differences can be found on the way the shape of fingering is developed. Adaptive meshes tend to display fingering easier because of the enhcanced and stronger resolution in the interface. Inside the high permeability square region there is an acceleration of the flow with the maximum value of it at the interface as this starts to develops at the back of this region and onwards. %At this point attention should be given to the recovery rates as they can be illustrated from fig.{\ref{fig:recoveryrates}}. The breaking point, also known as the point the two curves meet where beyond that water production will occur, is shifted towards the right as MR is increased.

\section{Conclusions}

\medskip
A number of different cases have been illustrated in Section \ref{section:results}. Starting from tested experimental cases and geometrical domains to verify that the numerical model is working and set up some initial benchmarks, to more complicated cases where various scenarios were implied. Observations made on various mobility ratios, geometrical domains and permeability zones as well as on the role of interfacial forces on the developement of the flows. For immiscible displacements upon which only viscous and capillary forces are acting (being horizontal flow, gravity can be ignored), the expected displacement patterns are either stable front displacement or unstable front displacement. In the latter case the instability arises due to either capillary or viscous fingering depending on capillary number ($N_{c}$) but mainly on mobility ratio (MR). If the mobility ratio is significantly less than $5$ (MR=$3$ has been used) , it is expected to find capillary fingering at relatively low flow rate and viscous fingering at relatively high flow rate. On the other hand, when the viscosity ratio is greater than $5$, the two basic forms of immiscible displacement are capillary fingering at relatively low flow rate and stable displacement at relatively high flow rate. Therefore for an i.e., water/oil system, the first condition applies as the viscosity of injected water is less than the viscosity of displaced oil. Hence, the displacement form could be either capillary fingering at relatively low injection rates or viscous fingering at higher injection rates. 

%\medskip
%We have numerically computed the evolution of the initial condition and for various values of the viscosity contrast under the same initial conditions and surface tension. Even though the commercial simulators provide the user with option of an unstructured type of mesh still they are not able to dynamically adapt the mesh as the simulation develops and they increase the computational cost as the saturation front changes slowly. In this paper the use and benefits of dynamic mesh adaptivity to capture the viscous fingering in reservoir flows was introduced. 

\medskip
As usually seen for high viscosity contrast, the leading finger screens out the trailing by suppressing its growth to the point that smaller fingers will break out driven by surface tension. At long times the large finger advances approximately at
constant velocity. Results which question the evolution of fingers and the finger competition are those referring to the dynamic role of viscosity contrast.

\medskip
In summary, the method that has been described in this paper as well as the simulations performed have a number of distinct advantages: 
\begin{enumerate}
\item[1.] The geological model can be designed from the beginning without any previous reference or geometrical limitations due to both the flexibility of method and to the fact that the geological characteristic and parameters can be easily introduced.
%\item[2.] Computational cost can be reduced because the complex geometries and surfaces are less expensive to generate and manage using fewer grid cells.
%\item[3.] The basis of the below argument is the flexibility and variance of the unstructured grid in time and space.
%\item[4.] Production simulations run directly on the geological model without the need to upscale.\\

\item[2.] The displacing fluid tends to flow easier towards the zones with higher values of permeability, as these can been seen from evolution of fingers in the upper layers of the domain. The higher the mobility ratio the easier it is for the uniform front of the injected fluid to break into fingers that eventually will decrease the recovery of hydrocarbon content.
\item[3.] The increased viscosity ratio increases the computational cost and requires the use of smaller time-step sizes. At the same time the basis of the argument above is the flexibility and variance of the unstructured grid in time and space. The domain used in these test-cases the development of the flow follow the linear tip-splitting finger behaviour.
\item[4.] Properties such as porosity and saturation can be readily up-scaled using statistical methods, can be included in the element boundaries,  while production simulations run directly on the geological model without the need to upscale.
\end{enumerate}

%\KCnote{Having confirmed that equal viscosity fluids do not finger into each other, a set of experiments were completed at different mobility ratios. Keeping both the thickness and the injection rate constant, it was observed that increasing the mobility ratio decreases the finger width, which subsequently leads to more fingers and subsequently more complexity at a given distance away from the injection point. Tip-splitting, a phenomenon in which the initial stage of fingers split into two or more new fingers, can also be observed at higher mobility ratios.}

\section{Achknowledgements}
Mr William Rad\"unz would like to acknowledge the support from the Brazilian Research Council (CNPq) under the \textit{Science without Borders scholarship programme}. Mr Konstantinos Christou would like to acknowledge the support of the University of Aberdeen - College of Physical Science as well as the Aberdeen Formation Evaluation Society (\textit{AFES}). 

\clearpage 
%% References with bibTeX database:
\bibliographystyle{elsarticle-harv}
\bibliography{references}

\clearpage
\listoffigures
\clearpage

\input{article_figure1}
%\input{article_figure2}


\end{document}
%% End of tex file.

%%  LocalWords:  checkboard
