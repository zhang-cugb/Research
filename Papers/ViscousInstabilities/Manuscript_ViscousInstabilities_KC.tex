% Copyright 2007, 2008, 2009 Elsevier Ltd
%
% This file is part of the 'Elsarticle Bundle'.
% ---------------------------------------------
%
% It may be distributed under the conditions of the LaTeX Project Public
% License, either version 1.2 of this license or (at your option) any
% later version.  The latest version of this license is in
%    http://www.latex-project.org/lppl.txt
% and version 1.2 or later is part of all distributions of LaTeX
% version 1999/12/01 or later c.
%
% The list of all files belonging to the 'Elsarticle Bundle' is
% given in the file `manifest.txt'.
%

% Template article for Elsevier's document class `elsarticle'
% with harvard style bibliographic references
% SP 2008/03/01
%
%
%
% $Id: elsarticle-template-harv.tex 4 2009-10-24 08:22:58Z rishi $
%
%
\documentclass[preprint,authoryear,12pt]{elsarticle}

% Use the option review to obtain double line spacing
%\documentclass[authoryear,preprint,review,12pt]{elsarticle}

% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
% for a journal layout:
%\documentclass[final,authoryear,1p,times]{elsarticle}
%\documentclass[final,authoryear,1p,times,twocolumn]{elsarticle}
%\documentclass[final,authoryear,3p,times]{elsarticle}
%\documentclass[final,authoryear,3p,times,twocolumn]{elsarticle}
%\documentclass[final,authoryear,5p,times]{elsarticle}
%\documentclass[final,authoryear,5p,times,twocolumn]{elsarticle}

%% if you use PostScript figures in your article
%% use the graphics package for simple commands
%% \usepackage{graphics}
%\usepackage{cases}
%% or use the graphicx package for more complicated commands
\usepackage{graphicx}
%% or use the epsfig package if you prefer to use the old commands
\usepackage{epsfig}

\usepackage{comment}

\usepackage{epstopdf}
\usepackage{pdflscape}
\usepackage{bm}
\usepackage{hyperref,url}
\hypersetup{colorlinks=true, urlcolor=blue, linkcolor=blue, citecolor=red}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb,amsmath,array}
%The amsthm package provides extended theorem environments
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{subfigure}  
%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
%% \usepackage{lineno}

\usepackage{lscape}

%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon (default)
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   authoryear - selects author-year citations (default)
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%   longnamesfirst  -  makes first citation full author list
%%
%% \biboptions{longnamesfirst,comma}

% \biboptions{}

\newcommand{\JGnote}[1]{\fbox{\parbox{\textwidth}{ \color{red} JG Note $\Rightarrow$ #1}}}
\newcommand{\KCnote}[1]{\fbox{\parbox{\textwidth}{ \color{black} KC Note $\Rightarrow$ #1}}}
\newcommand{\red}{\textcolor{red}}
\newcommand{\blue}{\textcolor{blue}}
\newcommand{\green}{\textcolor{green}}
\journal{Advances in Water Resources}
\newcommand{\frc}{\displaystyle\frac}
\newcommand{\PN}[2][error]{P$_{#1}$DG-P$_{#2}$}
\newcommand{\PNDG}[2][error]{P$_{#1}$DG-P$_{#2}$DG}

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\title{ \blue{Numerical Investigation of Multi-Fluid Flows through Dual Saturated-Unsaturated Porous Media - change the title to something close to the main topic of the manuscript ... something with viscous flow instability or viscous fingering)}}

%% use optional labels to link authors explicitly to addresses:
\author[UoA]{K. Christou} \author[UoA,UFRGS]{W.C. Rad\"unz}  \author[UoA]{B. Lashore} \author[UESC]{F.B.S. de Oliveira}
\author[UoA]{J.L.M.A. Gomes\corref{cor1}}\ead{jefferson.gomes@abdn.ac.uk}

\cortext[cor1]{Corresponding author.}
\address[UoA]{Environmental and Industrial Fluid Mechanics Group, School of Engineering, University of Aberdeen, UK}
\address[UFRGS]{Engineering School, Federal University of Rio Grande do Sul, Brazil}
\address[UESC]{Department of Exact and Technological Sciences, State University of Santa Cruz, Bahia, Brazil}

\begin{abstract} 
Numerical modelling of multiphase flow in porous media has a wide range of applications in science and engineering. Viscous fingering, a fluid instability can be a major concern regarding enhanced oil-recovery methods (EOR). Continuity equation and the Darcy's law govern the processes, while pressure, velocity, saturation and permeability are quantities that define the behaviour of the flow. A novel control finite element method (CVFEM) is used to discretize the governing equations that will solve the multi-fluid porous media flow model. The current model is the basis of a general purpose flow simulator that is equipped with anisotropic mesh adaptivity techniques to increase the computational accuracy of numerical methods used in geophysical fluid mechanics and tackle the difficulties that commercial resevoir simulators may rise when using low order finite volume/differences methods based on structured grids. The governing multiphase porous media flow equations are solved using an adaptive and unstructured mesh. The model is based upon two key numerical characteristics: (a) the family of $P_{n}DG-P_{n+1}$ finite element pairs and (b) a consistent overlapping control volume finite element method (CVFEM) formulation.
Moreover, the mesh adaptivity algorithm employs multi-constraints on element size in different regions of the porous medium to resolve multi-scale transport phenomena. The scheme captures the key characteristics of the flow while its applicable to heterogeneous porous media and geological formations. We conclude that understanding the multiphase flow properties will allow us to efficiently facilitate more efficient oil \& gas recovery, efficient contaminant removal and better planning of carbon capture and storage (CCS) projects. 

%\JGnote{ Abstracts for journal papers have very `squared-structure': (a) Motivation (why would anyone bother to read the paper? Why is it (the paper and/or the subject) relevant? This needs to be covered in 1-3 punchy sentences.); (b) (Main) Objective(s) of the manuscript with particular focus on the \underline{novelty(ies)} the paper may bring (this should be covered in 2-6 (very dry) sentences); (c) Summary of the main technologies that you are using or introducing (and, in some cases, how this/these link(s) with (a), 2-6 sentences); (d) Summary of the main findings (linkage with (b), 2-3 sentences).}

\end{abstract} 

\begin{keyword} %% keywords here, in the form: keyword \sep keyword
  Viscous Instabilities \sep Mobility Ratio \sep Multi-fluid flows \sep Porous media \sep Finite Element Methods. \blue{(choose key-words that do represent the contents of the paper. State-of-the-art development -re key-words should be represented as literature review in the Introduction section.)}
\end{keyword}

\end{frontmatter}

%\tableofcontents
%\linenumbers

\clearpage

%%%         %%%
%%% SECTION %%%
%%%         %%%
\section{Introduction}\label{section:Intro}

Numerical investigation and modelling of multiphase flows in porous media have attracted the attention of the scientific community over the past 40 years. Characterization of the flow of fluids through porous media serves as the foundation of reservoir engineering studies. Reservoir engineers and hydro-geologists are dealing with complex geometries, irregular boundaries and heterogeneous geological formations. Out of this mixed and complex formations, viscous flow instabilities can occur both within a single phase or when multiple phases flow through porous media. Forecasting the behaviour of multiphase flows or the future response of the system are major challenges that need to be taken into account. Injections of low-viscosity, high-density fluid $1$ (e.g. water) into a reservoir saturated with lighter but more viscous oil is an example where both viscous and gravitational instabilities may occur for two-phase immiscible and incompressible flow. These phenomena have great importance during the oil and gas recovery operations in both mature and new fields. Starting from oil and gas migration of contaminants through groundwater is the opposite problem governed by the same principles. The most complicated of processes include fingering that wil loccur in multiphase and compositional flow. Underground coal gasification is another potential application but more recently on CO$_{\text{2}}$ migration and trapping mechanisms in carbon capture and storage (CCS) operations~\citep{spycher_2003, chen_2006, self_2012, pruess_1990c, white_1981,jiang_2011}.

\medskip
The conservation of mass along with Darcy's law are the governing equations that describe the flow pattern. Particle methods, front-tracking methods \citep{univerdi_1992} but in particular volume of fluid (VOF) methods \citep{hirt_1981,rider_1998} are used to describe the afformentioned properties. In addition, finite difference methods have been applied to discretise the governing equations \citep{Luo2016,Moortgat2016,Hoteit2008}. This work will mainly focus on macroscale flow instabilities or \textit{viscous fingering} in heterogeneous resevoirs -or computational domains- and will compare the development of fingers using an alternative finite element method. 
In conventional reservoirs the principal forces that affect fluid flow include, viscous forces, effects of gravity and permeability diffrences while in unconventional gas reservoirs flow simulation models take into account the phenomena of adsorption and diffusion \citep{abdus_2015}. Even though the mechanisms of the instabilities may vary, however it is still a function of relative mobility, gravity, viscous forces and permeability differences. All these parameters are represented under one term in the global mass balance equation.   

\medskip
The objective of this study is to investigate and accurately describe the behaviour of fingering in multiphase ($2$-phase) flows using a control volume finite element method (CVFEM). Considering the limitations of finite differences formulations the CVFE the model formulation will use a conservative computational multi-fluid porous media flow model able to exploit mesh adaptivity methods on a fully-unstructured tetrahedral grid. Also two key characteristics that describe the model above are: (a) the hybrid element pair $P_{n}DGP_{n+1}$ which provides discontinuous and piecewise representation for velocity and pressure fields at FE space and (b) the overlapping control volume finite element method (CVFEM)formulation.

\medskip
The sections that follow include a summary of the main governing equations for multiphase compositional flow. The remainder of the paper will include a description of the viscous fingering along with the finite element method technique, a discussion of simulations results and the key conclusions. The analysis will consider ($1$)permeability heterogeities, ($2$)capturing the development of the interface and the evolution of fingers, ($3$)test-case comparison, but for now will neglect any gravitational effects. 

%These are techniques which are usually employed to solve problems that fail because of certain types of heterogeneities. These cases are normally resolved by stochastic representation of permeability and porosity fields. There are several approaches to upscale solutions, while three common types are discussed. The $1^{st}$ assumes capillary equilibrium and calculates effective relative permeability using a suitable technique, such as numerical methods, percolation methods and space re-normalization methods. The $2^{nd}$ approach is called pseudoization. It generates a psuedo relative permeability by matching immiscible displacement simulation of a coarse-grid to the output of fine-grid simulations. The $3^{rd}$ approach involves direct calculation of relative permeability from displacement experiments.~\citep{johnson_1959, jones_1978}. Problems start to rise when complex flow patterns will appear during the recovery of hydrocarbons triggered by heterogeneities.  
%The first approach is limited to low flow rates and very small heterogeneities. The second approach overcomes these limitations but also posses drawbacks such us, unavailability of fine-grid simulation with suitable level of accuracy, dependence of the pseudo functions on rate, direction and grid specification. The experimental data from the third approach is only suitable for a small class of scenarios.~\citep{Chang_1994}. While  non-uniform permeability and porosity may be easy to deal with at a microscopic scale for porous media flow equations, it presents a lot of challenges at a meso/field scale, which is required for reservoir simulations. 

%\JGnote{As a rule of thumb, when you are introducing a paragraph, the very first sentence needs to give the reader a clue of either linkage with previous paragraphs or linkage with the main subject(s).}  

%\medskip
%Under certain geological conditions the displacement of fluids in porous media is unstable and results in the formation of irregular flow patterns in the form of fingers %\textit{fingers}. 
%These patterns are also described as flow instabilities or \textit{viscous fingering},  or most widely known as Saffman-Taylor instabilitises. This phenomenon will occur during an unfavorable -mobility-ration displacement, when a more viscous fluid is displaced by a less viscous (Saffman and Taylor $1958$). The mechanism of the instabilities may vary, 
%(in immiscible fluids the most important factor is the surface tension while in miscible fluids, it is the diffusion \red{(thermal or mass diffusion ...be specific)})
%however it is still a function of relative mobility, gravity, viscous forces and permeability differences. In conventional reservoirs the principal forces that affect fluid flow include, viscous forces, effects of gravity and permeability diffrences while in unconventional gas reservoirs flow simulation models take into account the phenomena of adsorption and diffusion \citep{abdus_2015}.


%\blue{The Introduction Section of a manuscript is often divided into 4 parts:
%   \begin{enumerate}[(a)]
%       \item Motivation for the work undertaken. What are the environmental, industrial and/or lab problems that this work will help tackling and/or solving (first and \underline{only one} paragraph)? 
%       \item Literature review: this should focus on the main topics directly related to the manuscript (as a rule-of-thumb, you should choose up to 5 key-words that can better represent the work and write \underline{concisely} about recent development on them, i.e., state-of-the-art). Length of literature review should be 3-10 paragraphs and focus on `recent' developments in the topics including strengths and weakness. This `list' of topics (with associated references and range of strengths and weakness) may lead to {\it an explicit statement of the current gap of knowledge on the field that the manuscript will address}. This last key sentence will naturally lead to the;
%       \item Main aim and (list of) objective(s) of the work and how you intend to tackle the science problem (1 paragraph);
%       \item Summary of the work (last paragraph). 
%   \end{enumerate}
%}




\section{Problem set-up}\label{problem_set_up}      
 
Multiphase flow in porous media is described by mass conversation (or transport) equation and Darcy velovities for each of the phase $\alpha$ (with \alpha = g, o, w, fro gas, oil, and water phases).

\subsection{Mathematical Formulation}\label{section:math-model}
%\medskip

\KCnote{ - - to be putted in the mathematical formulation as intro - - 
Fingering will occur in miscible displacments when the viscocity ratio is greater than unity. As surface tension becomes weak, the front of the steady finger is susceptible to a viscous-fingering instability by the basic mechanism associated with a less viscous fluid displacing a more viscous one. After a split, each of the new lobes of the finger is stable as a result of their being thinner than the finger from which they split. As a result of \textit{shielding}, one of these lobes will eventually outgrow the others and will then spread to occupy the appropriate width of the cell. In the process, it reaches a width that is again unstable to splitting, and the pattern repeats. Thus, surface tension plays an essential dual role; it must be weak enough for the tip front to be unstable, but it is also the physical force causing the \textit{spreading} and ensuing repeated branching. Important parameter is the mobility (or viscosity) ratio. This is given by Eqn.~\ref{eq:mobility-of-fluid} where $K$ is absolute permeability and $k_{r}$ is relative permeability :

\begin{equation}
\lambda = \frac{K\;k_{\alpha}}{\mu}
\label{eq:mobility-of-fluid}
\end{equation}

}

The displacing and displaced fluids are considered to be incompressible and immiscible under isothermal and no source or sink conditions. In addition, we neglect the effects of capillarity and gravity in our simulations. Therefore the governing equations of conservation of mass and Darcy's law can be described below as, 

\begin{equation}\label{e:darcy_eqn}
  \mathbf{q}_{\alpha} = -\frac{\mathcal{K}_{{r}_\alpha}\mathbf{K}}{\mu_{\alpha}}\left(\nabla p_{\alpha} - {\mathbf{s}_{u}}_{\alpha} \right),
\end{equation}
where $\mathbf{q}_{\alpha}$ is the $\alpha$-th phase Darcy velocity, $\mathbf{K}$ is the absolute permeability tensor of the porous medium, $\mathcal{K}_{{r}_\alpha}\left(S_{\alpha}\right)$ is the phase relative permeability, which is a function of the phase saturation $S_{\alpha}\left(\mathbf{r},t\right)$. $\mu_{\alpha}$, $p_{\alpha}$, $\rho_{\alpha}$, and $\mathbf{s}_{{u}_\alpha}$ are the phase dynamic viscosity, pressure, density and source term, which may include gravity and/or capillarity, respectively. 

Introducing a saturation-weighted Darcy velocity defined as $\mathbf{u}_\alpha= \mathbf{q}_\alpha/S_\alpha$, then Eqn.~\ref{e:darcy_eqn} may be rewritten as:
\begin{equation}
  \mathbf{v}_\alpha={\underline {\underline \sigma}}_{\alpha} \mathbf{u}_{\alpha} = - \nabla p_{\alpha} + {\mathbf{s}_{u}}_{\alpha},
  \label{force-bal}
\end{equation}

where ${\underline {\underline \sigma}}_{\alpha}=\mu_\alpha S_\alpha \left(\mathcal{K}_{{r}_\alpha}\mathbf{K}\right)^{-1}$ represents the implicit linearisation of the viscous frictional forces. Assuming a porous media domain $\Omega\subset\mathcal{R}^{n}$ ($n$ is the number of dimensions). Darcy's law for single phase flow can be extended (from Eq.\ref{e:darcy_eqn}) for immiscible multiphase flow to Eq.\ref{E:darcy_eqn} below,

\begin{equation}
  \mathbf{q}_{\alpha} = -\frac{\mathcal{K}_{{r}_\alpha}\left(S_{\alpha}\right)\mathbf{K}}{\mu_{\alpha}}\left( \nabla p_{\alpha} - {\mathbf{s}_{u}}_{\alpha} \right),
%S_{k}\left(\lambda_{k}\mathcal{K}\right)^{-1}\phi v_{\alpha} = \underline{\underline{\sigma}}_{\alpha} {\bf u}_{\alpha} = -\nabla p + \mathcal{S}_{u},
\label{E:darcy_eqn}
\end{equation}
where $\mathbf{q}_{\alpha}$ is the $k\left(\in\left\{1,N_{p}\right\}\right)$-phase Darcy flow rate. $S$, $\mathbf{K}$, $\mathcal{K}_{r\alpha}\left(S_{\alpha}\right)$ and $\mu$ are saturation, absolute permeability tensor, phase relative permeability and viscosity, respectively. $s_{u}$ is a source term (e.g., gravity force) associated with the force balance and $p$ is the pressure.

 Defining the advective velocity averaged over the entire domain -- $\mathbf{u}_{\alpha}= \mathbf{q}_{\alpha}/S_{\alpha}$, then we may rewrite Eq.(\ref{E:darcy_ext}),
\begin{equation}
  {\underline {\underline \sigma}}_{\alpha} \mathbf{u}_{\alpha} = - \nabla p + {\mathbf{s}_{u}}_{\alpha},
  \label{E:darcy_ext}
\end{equation}
$\underline{\underline{\sigma}}_{\alpha}=\mu_{\alpha}S_{\alpha}\left(\mathcal{K}_{r\alpha}\mathbf{K}\right)^{-1}$ represents the implicit linearisation of the viscous frictional forces, and is piecewise constant within each FE and is obtained via basis functions local to each CV within each element \citep{Jackson13,Radunz14}.

The two-phase flow through the porous media $\Omega$ may be described by the coupled extended Darcy and global mass conservation equations,

\begin{eqnarray}
\left(\displaystyle\frac{\mu_{\alpha}S_{\alpha}}{{\mathbf K}\mathcal{K}_{r\alpha}}\right) {\mathbf u}_{\alpha} = \underline{\underline{\sigma}}_{\alpha} {\mathbf u}_{\alpha} = -\nabla p + \mathcal{S}_{u,\alpha},\;\;\; x_{i}\in\Omega, t>0 \label{eqn:darcy_eqn} \\
\phi\displaystyle\frac{\partial S_{\alpha} }{\partial t} +   \nabla \cdot \left( {\mathbf u}_{\alpha}  S_{\alpha}\right) =  \mathcal{S}_{cty,\alpha},\;\;\; x_{i}\in\Omega, t>0\label{eqn:saturation_eqn}
\end{eqnarray}

where $S$, $\mu$, ${\bf K}$, $p$ and $\phi$ are the saturation, viscosity, absolute permeability, pressure and porosity, respectively. ${\mathbf u}_{k}$ is the saturation-weighted Darcy velocity of the $k$-phase and $\mathcal{K}_{r,\alpha}$ is the relative permeability. $\mathcal{S}$ is the source term associated with the Darcy and continuity equations. $S_{\alpha}$ is saturation of the $\alpha$-phase with the constraint of $\sum\limits_{\alpha=1}^{\mathcal{N}_{p}} S_{\alpha} = 1$, where $\mathcal{N}_{p}$ denotes the number of phases.

\medskip
Finite element basis functions for velocity and pressure fields are introduced in the discretisation of force-balance equation -- Eqn.~\ref{eqn:darcy_eqn}. Hybrid (i.e., overlapping) basis functions are also developed to allow CV-based velocity to be extrapolated across the entire element. $\underline{\underline{\sigma}}_{k}=\underline{\underline{\sigma}}_{k}\left({\mathbf K}, \mathcal{K}_{rk}, S_{K}, \mu_{k}\right)$ is an absorption-like term that lies in both CV and FEM spaces. Though, whilst the saturation field is calculated in CV space, permeability $\left({\mathbf K}\right)$ is piecewise constant in FE space to allow efficient representation of surface parametrised geometries. The global saturation equation (Eqn.~\ref{eqn:saturation_eqn}) is discretised in space with CV basis function and with the $\theta$-method in time as described by \citet{gomes_book_2012}. Velocities across CV interfaces (within and between elements, see fig.\ref{fig:fem_cv} below) are calculated through a directional-weighted flux-limited scheme based on upwind value of $\sigma$ at individual CV as described by \citet{gomes_2013}~\citep[see also][]{jackson_2013}.

\begin{figure}[h]
\centering
\includegraphics[width=.5\textwidth]{./Pics/P1DGP2.PNG}
\caption{2D representation of the element pairs presented in this work. Shaded areas denote control volumes (in which saturation is stored), black points represent the pressure nodes and white points the velocity nodes. Note that in (b) velocity and pressure nodes overlap in the triangles' vertices.}
\label{fig:fem_cv}
\end{figure}

\section{The Overlapping CVFEM formulation}

Finite difference methods (FDM) have been extensively used in most industry-standard flow simulators~\citep{aziz_1986, chen_2005, chang_1990} with relative success in multi-physics single phase applications (e.g., black oil model, passive tracer advection etc). Analytic models can be used to analyze reservoir performance as long as the reservoir is not highly heterogeneous. However, FDM are often limited to relatively simple geometries 
%(with low grid quality and orientation) 
representing idealised geological formations~\citep{mlacnik_2004, king_1999}. Additionally, FDM produce excessive numerical dispersion when heterogeneity (represented by permeability and porosity fields) is present~\citep{chavent_1986}. The geometrical flexibility associated with high-order numerical accuracy of finite element methods (FEM) has proven to overcome these deficiencies. 

Among FEM-based formulations for porous media, the control volume finite element methods (CVFEM) ~\citep[CVFEM,][]{fung_1992,cordazzo_2004} has been largely used as it can guarantee local mass conservation and high-order numerical accuracy as well as being able to use tetrahedral geometry-conforming elements~\citep{forsyth_1990, geiger_2004, hurtado_2007}. In this formulation, standard Galerkin-FEM method is used to discretise the pressure equation (FEM representation of pressure and velocity fields) whereas a control volume-based formulation is used to discretise all remaining scalar fields~\citep[e.g., saturation, density, species concentration etc, see][]{gomes_book_2012}. 

In the CVFE method pressure is interpollated using piecewise linear finite element basis functions (Eq.\ref{cvfe_pressure}) while saturation is represented in node centered CV basis (Eq.\ref{cvfe_saturation}) control volume basis functions respectevely:

\begin{equation}
 p^{n} = \sum_{j} \hat{p_{j}} N_{\alpha} 
\label{cvfe_pressure}
\end{equation}

\begin{equation}
 S^{n} = \sum_{j} \hat{p_{j}} M_{b} 
\label{cvfe_saturation}
\end{equation}

where $N_{\alpha}$ is first order finite element basis function and $M_{b}$ is the control volume basis function that is equal to unity over the control volume constructed around node j and is equal to zero everywhere else. The saturation equation is solved explicitly after solving for pressure at each time.

Control volume finite element methods require high resolution meshes in regions where material properties vary abruptly, such as permeability and/or porosity contrasts at fracture-matrix interfaces. Since geometries are captured by finite elements (FE), constructed control volumes (CV) typically extend over the interfaces which may have different properties. Therefore, some average value of the permeability (defined in the FE space but projected into the CV space) is applied across the CVs at these interface. This often leads to excessive numerical dispersion especially in highly heterogeneous media. In order to overcome such artificial numerical dispersion, discontinuous hybrid finite element finite volume method (DFEFVM) was developed by \citet{nick_2011b, nick_2011a}. This novel discretisation scheme was designed to simulate flows through discrete fractured rocks in which CVs are divided along the interfaces of different materials.  

\citet{cumming_2011} demonstrated that CVFEM discretisation could also be used to solve Richards' equations (coupled mass conservation and Darcy equation) in heterogeneous media with relatively small computational overhead~\citep[compared with traditional coupled velocity-pressure based formulations, see also][]{cumming_phd2012}. Fluxes over CVs were calculated based upon material properties, whereas the saturation fields were volume-averaged at the interface of the materials, enforcing mass balance as described by \citet{kirkland_1992}.


%\medskip 
%\begin{center}
%\JGnote{WR: small summary of the paper -- 3 or 4 punchy sentences %followed by description of the remaining of the paper}
%\end{center}

%\textcolor{red}{The impact of heterogeneous porous media in fingers formation using a FEM-based unstructured fixed mesh multi-fluid model with uniform permeability distribution under both saturated and unsaturated porous media}. The overlapping control volume finite element method (OCVFEM), formulation recently introduced by~\citet{jackson_2013}~\citep[see also][]{gomes_2013,pavlidis_2013} is used to investigate the development of multiphase flows through heterogeneous porous media.This finite element based method has a dual pressure-velocity representation in CV and FEM spaces  are embedded into a family of triangular/tetrahedral element pairs, P$_{m}$DG-P$_{n}$~\citep{cotter_2009b} and P$_{m}$DG-P$_{n}DG$~\citep{xie_2014}. The dual velocity and pressure fields are represented by $m^{\rm th}$- (discontinuous) and $({n})^{\rm th}$-order (continuous/discontinuous) polynomials, respectively.
%Moreover, velocity field has dual mapping in FEM and CV spaces. This approach can achieve an exact representation of the Darcy force balance equations. 
%In addition, the study focused in flow instabilities determined by the viscosity ratio. In the simulations presented in this paper the element pairs as described above and the overlapping control volume finite element method (CVFEM) model were used, in which the dual velocity-pressure fields are embedded in FEM space with simultaneous projection into CV space. Scalar fields (e.g., saturation, concentration, density, etc) are represented in the control volume space. High-order accurate downwind schemes on element boundaries on discontinuous scalar fields are flux-limited (based on NVD approach) to obtain bounded and compressive (capturing the interfaces) solutions. Section $2$ summarises the numerical formulation used in this work, followed by description of the flow instabilities  and a description of model validation. Finally, conclusions are drawn in the final section.

%Numerical investigation and modelling of multiphase flows in porous media have attracted the attention of the scientific community over the past 40 years. Reservoir engineers and hydro-geologists are dealing with complex geometries, irregular boundaries and heterogeneous geological formations. Forecasting the behaviour of multiphase flows or the future response of the system are major challenges that need to be taken into account. This is mainly due to the importance of the oil and gas recovery operations, groundwater exploration, underground coal gasification, and more recently on CO$_{\text{2}}$ migration and trapping mechanisms in carbon capture and storage (CCS) operations~\citep{spycher_2003, chen_2006, self_2012, pruess_1990c, white_1981,jiang_2011}.


The conservation of mass along with Darcy's law are the governing equations while variables such as pressure, velocity,saturation and permeability define the behaviour of the flow. Finite difference methods have been applied to discretise the governing equations \citep{Luo2016,Moortgat2016,Hoteit2008} .The objective of this work is to investigate and accurately describe the behaviour of fluid instabilities in compositional flows using a control volume finite element method (CVFEM). Most commercial reservoir simulators use low-order finite-volume/differences methods based on structured grids. Considering the limitations of finite differences formulations, the CVFE The model formulation will use a conservative computational multi-fluid porous media flow model able to exploit mesh adaptivity methods on a fully-unstructured tetrahedral grid. Also two key characteristics that describe the model above are: (a) the hybrid element pair $P_{n}DGP_{n+1}$ which provides discontinuous and piecewise representation for velocity and pressure fields at FE space and (b) the overlapping control volume finite element method (CVFEM)formulation.


%Both permeability and porosity are important parameters in the equations used for numerical simulation of multiphase flow in porous media.\red{(what was the objective of this sentence?)}  %Heterogeniety of permeability and porosity is a product of the medium's formation process %-- deposition and diagenesis -- and exists at different scales. 
%To tackle these problems the continuum approach, in a microscopic level, can be applied to a representative elementary Volume (REV) to describe the spatial variation in parameters such as the porosity and permeability~\citep{bastian_phd1999}. %This is well suited for analysis of small scales such as core samples. \red{(These sentences are not linked with the previous sentences, also what is the objective of them? )}. 

%Larger scale problems can be approached by upscaling techniques. These are techniques which are usually employed to solve problems that fail because of certain types of heterogeneities. These cases are normally resolved by stochastic representation of permeability and porosity fields. 
%Various upscaling techniques, including analytical and numerical, have been introduced in the literature to calculate upscaled flow properties.
%There are several approaches to upscale solutions, while three common types are discussed. The $1^{st}$ assumes capillary equilibrium and calculates effective relative permeability using a suitable technique, such as numerical methods, percolation methods and space re-normalization methods. The $2^{nd}$ approach is called pseudoization. It generates a psuedo relative permeability by matching immiscible displacement simulation of a coarse-grid to the output of fine-grid simulations. The $3^{rd}$ approach involves direct calculation of relative permeability from displacement experiments.~\citep{johnson_1959, jones_1978}.
 
%The first approach is limited to low flow rates and very small heterogeneities. The second approach overcomes these limitations but also posses drawbacks such us, unavailability of fine-grid simulation with suitable level of accuracy, dependence of the pseudo functions on rate, direction and grid specification. The experimental data from the third approach is only suitable for a small class of scenarios.~\citep{Chang_1994}. While  non-uniform permeability and porosity may be easy to deal with at a microscopic scale for porous media flow equations, it presents a lot of challenges at a meso/field scale, which is required for reservoir simulations. 

%\medskip
\begin{comment}
Finite difference methods (FDM) have been extensively used in most industry-standard flow simulators~\citep{aziz_1986, chen_2005, chang_1990} with relative success in multi-physics single phase applications (e.g., black oil model, passive tracer advection etc). However, FDM are often limited to relatively simple geometries (with low grid quality and orientation) representing idealised geological formations~\citep{mlacnik_2004, king_1999}. Additionally, FDM produce excessive numerical dispersion when heterogeneity (represented by permeability and porosity fields) is present~\citep{chavent_1986}. The geometrical flexibility associated with high-order numerical accuracy of finite element methods (FEM) has proven to overcome these deficiencies. 


%Detailed numerical investigation of multiphase flows in porous media has attracted the attention of the scientific community for the past 50 years. This is mainly due to applications in oil and gas exploration, groundwater resources, underground coal gasification, geothermal power systems and, more recently, in carbon capture and storage (CCS) processes~\citep{spycher_2003, chen_2006, self_2012, pruess_1990c, white_1981, jiang_2011}. However, current porous media multiphase flow models are plagued with uncertainties associated with subsurface topology, lithostratigraphic heterogeneity and chemical and physical properties of subsurface fluids. Viscous fingering, a flow instability phenomenon that occurs at the interface of fluids with distinct viscosities, has a strong impact on the efficiency of both oil recovery and CO$_{2}$ trapping under reservoir conditions.

%Accurate prediction of multiphase flow behaviour through realistic porous media domains is one of the main research challenges as \red{write about the main issues related to heterogeneity and link it with flow behaviour (2-5 sentences with references)}. 

%\red{\bf Write here \underline{3-6 literature review paragraphs based on} the chosen \underline{key-words} with the associated references. \underline{Be concise}!}

%Forecasting the behaviour of multiphase flows or the future response of the system are major challenges that need to be taken into account. 
%Both permeability and porosity are important parameters in the equations used for numerical simulation of multiphase flow in porous media.\red{(what was the objective of this sentence?)}  %Heterogeniety of permeability and porosity is a product of the medium's formation process %-- deposition and diagenesis -- and exists at different scales. 
%To tackle these problems the continuum approach, in a microscopic level, can be applied to a representative elementary Volume (REV) to describe the spatial variation in parameters such as the porosity and permeability~\citep{bastian_phd1999}. %This is well suited for analysis of small scales such as core samples. \red{(These sentences are not linked with the previous sentences, also what is the objective of them? )}. 

%Larger scale problems can be approached by upscaling techniques. This technique which is usually employed to solve the problem fails for certain types of heterogeneity. These cases are normally resolved by stochastic representation of permeability and porosity fields. 
%Various upscaling techniques, including analytical and numerical, have been introduced in the literature to calculate upscaled flow properties. There are several approaches to upscale the solutions, while three common types are herein discussed. The $1^{st}$ assumes capillary equilibrium and calculates effective relative permeability using a suitable technique, such as numerical methods, percolation methods and space renormalization methods. The $2^{nd}$ approach is called pseudoization. It generates a psuedo relative permeability by matching immiscible displacement simulation of a coarse-grid to the output of fine-grid simulations. The $3^{rd}$ approach involves direct calculation of relative permeability from displacement experiments.~\citep{johnson_1959, jones_1978}. \red{Try to rewrite this paragraph bearing in mind: (a) Is upscaling relevant for this manuscript? (b) If positive how are they related ? As we haven't introduced the main aim (and objectives) of the manuscript, such relationship must be added clearly and smoothly here.}
 %The first approach is limited to low flow rates and very small heterogeneity. The second approach overcomes these limitation but also posses drawbacks which include; availability of fine-grid simulation with suitable level of accuracy, dependence of the psuedo functions on rate, direction and grid specification. The experimental data from the third approach is only suitable for a small class of scenarios.~\citep{Chang_1994}. While  non-uniform permeability and porosity may be easy to deal with at a microscopic scale for porous media flow equations, it presents a lot of challenges at a meso/field scale, which is required for reservoir simulations. 

%\medskip
Under specfic spatial conditions the displacement of fluids in porous media is unstable and results in the formation of irregular flow patterns in the form of fingers. This phenomenon, viscous fingering, describes flow instabilities {\bf (and ...?? you are repeating the previous sentence ...)}. Even though the mechanism of instabilities may vary (in immiscible fluids the most important factor is the surface tension while in miscible fluids, it is the diffusion \red{(thermal or mass diffusion ?? be specific)}), however it is still a function of several variables such as, relative mobility, gravity, dispersion, permeability differences\red{(Is this true ?? if so give references. why is gravity or relperm relevant? dispersion... why? perm grad??)}. Moreover, in most cases \red{(refs?)} interfacial tension is directly linked with the mobility ratio (or viscosity ratio) between the displaced and the displacing fluid \red{(How and why?)}.
\medskip

\blue{This last paragraph before aims and objectives (next paragraph) should be gentle transition from current state-of-the-art and this work. As a suggestion, the last paragraph should focus on a particular aspect of viscous fingering that may not be well-understood by the scientific community and that is addressed in the paper. For example, (a) impact of heterogeneity in the onset of fingering, (b) qualitative sensitivity study of viscosity ratio impact in the finger formation (based on analytical assessment studies), etc.} 

The main aim of this work is to numerically investigate the impact of heterogeneous porous media in fingers formation using a FEM-based unstructured fixed mesh multi-fluid model with uniform permeability distribution under both saturated and unsaturated porous media. \red{\bf (try to develop it further; be more specific. Write this objective sentence/paragraph based on the paper's conclusions!)}. This study focuses on flow instabilities due to relatively large viscosity ratios.  

\citet{cumming_2011} demonstrated that CVFEM discretisation could also be used to solve Richards' equations (coupled mass conservation and Darcy equation) in heterogeneous media with relatively small computational overhead~\citep[compared with traditional coupled velocity-pressure based formulations, see also][]{cumming_phd2012}. Fluxes over CVs were calculated based upon material properties, whereas the saturation fields were volume-averaged at the interface of the materials, enforcing mass balance as described by \citet{kirkland_1992}.
\end{comment}

\begin{comment}
Under certain geological conditions the displacement of fluids in porous media is unstable and results in the formation of irregular flow patterns in the form of fingers %\textit{fingers}. 
The flow instabilities mentioned above are described as \textit{viscous fingering}. Even though the mechanism of the instabilities may vary, 
%(in immiscible fluids the most important factor is the surface tension while in miscible fluids, it is the diffusion \red{(thermal or mass diffusion ...be specific)})
however it is still a function of relative mobility, gravity, dispersion, permeability differences. Moreover, in most cases interfacial tension is directly linked with the mobility ratio between the displaced and the displacing fluid.

Both the evolution of visualisation techniques through the extensive use of parallel computing as well as the advances in modelling and simulation of porous media flows may help to address the importance of this phenomenon which can be found in petroleum, chemical and environmental operations. 

In this paper, a control volume finite element method (CVFEM) formulation, recently introduced by~\citet{jackson_2015}~\citep[see also][]{radunz_2014}, is used to investigate the development of multiphase flows through heterogeneous porous media. In this formulation, the dual pressure-velocity representation in CV and FEM spaces are embedded into a family of triangular/tetrahedral element-pairs, \PN[n]{m} and \PNDG[n]{m} \citep[][]{cotter_2009b,xie_2014} -- basis function with $n^{\rm th}$- (discontinuous) and $m^{\rm th}$-order (continuous/discontinuous) polynomials for velocity and pressure fileds, respectively.  Scalar fields (e.g., saturation, concentration, density, etc) are represented in the CV space. High-order accurate downwind schemes on element boundaries on discontinuous scalar fields are flux-limited (based on NVD approach) to obtain bounded and compressive (capturing the interfaces) solutions. This formulation can achieve an exact representation of the Darcy force balance equations.

In this paper, \textcolor{red}{the main objective is to investigate the impact of heterogeneous porous media in fingers formation using a FEM-based unstructured fixed mesh multi-fluid model with uniform permeability distribution under both saturated and unsaturated porous media}. The overlapping control volume finite element method (OCVFEM), formulation recently introduced by~\citet{jackson_2013}~\citep[see also][]{gomes_2013,pavlidis_2013} is used to investigate the development of multiphase flows through heterogeneous porous media.This finite element based method has a dual pressure-velocity representation in CV and FEM spaces  are embedded into a family of triangular/tetrahedral element pairs, P$_{m}$DG-P$_{n}$~\citep{cotter_2009b} and P$_{m}$DG-P$_{n}DG$~\citep{xie_2014}. The dual velocity and pressure fields are represented by $m^{\rm th}$- (discontinuous) and $({n})^{\rm th}$-order (continuous/discontinuous) polynomials, respectively.
Moreover, velocity field has dual mapping in FEM and CV spaces. This approach can achieve an exact representation of the Darcy force balance equations. 
In addition, the study focused in flow instabilities determined by the viscosity ratio. In the simulations presented in this paper the element pairs as described above and the overlapping control volume finite element method (CVFEM) model were used, in which the dual velocity-pressure fields are embedded in FEM space with simultaneous projection into CV space. Scalar fields (e.g., saturation, concentration, density, etc) are represented in the control volume space. High-order accurate downwind schemes on element boundaries on discontinuous scalar fields are flux-limited (based on NVD approach) to obtain bounded and compressive (capturing the interfaces) solutions. Section $2$ summarises the numerical formulation used in this work, followed by description of the flow instabilities  and a description of model validation. Finally, conclusions are drawn in the final section. 
\end{comment}

\medskip
\KCnote{Section~\ref{section:NumericalFormulation} summarises the numerical formulation used in this work. The model is validated against Bucklet-Leverett (incompressible fluid displacement in homogeneous domain) and traditional four-regions (cross-flow assessment due to permeability gradient) test-cases (Section~\ref{section:ModelValidation}). Viscous flow instabilities in heterogeneous porous media is numerically investigated in Section~\ref{section:ViscousInstabilities} following by final remarks.


%%%         %%%
%%% SECTION %%%
%%%         %%%
\section{Numerical Formulation}\label{section:NumericalFormulation}
The method presented here builds on that reported by \citet{jackson_2015} is known as OCVFEM formulation. The method developed is applicable to $N_{p}$ fluid phases and to the general family of $P_{n+1}(DG)-P_{n}(DG)$ element pair consistent dual pressure-velocity representation in control volume (CV) and finite element (FE) spaces. These element-pairs have a discontinuous $n^{th}$-order polynomial representation for velocity and a continuous representation of pressure. The mass balance (continuity) equations are solved in CV space and a Petrov-Galerkin finite element (FE) method is used to obtain the high-order fluxes on CV boundaries (fig.\ref{fig:fem_elem})  , which are limited to yield bounded fields.

\begin{figure}[h]
\centering
\includegraphics[width=.5\textwidth]{./Pics/P1DGP2_ele.png}
\caption{Porosity $\phi$, and permeability K are associated to the elements. The velocity nodes are associated to the element corners and the mid-points of the element edges as described in fig.\ref{fig:fem_cv}; pressure nodes are associated to the corners of the elements. The three CVs fit into a $2$D element. Saturation and saturation-dependent variables are stored CV-wise.}
\label{fig:fem_elem}
\end{figure}

Saturation, and all saturation-dependent material properties such as relative permeability and capillary pressure, are represented CV-wise. The pressure, a key difference to other CVFE methods reported previously, allows the use of CVs that do not span multiple FEs. Hence each CV (and FE) is associated with a unique set of petrophysical properties, in contrast to most previous methods in which CVs span multiple values of petrophysical properties described FE-wise.

As we have to be consistent with \citet{jackson_2015} we assume that rick and fluids are incopressible thus the mass ballance for phase $\alpha$ can be written as (Eq.\ref{mass_balance})

\begin{equation}
\phi \; \frac{\partial S_{\alpha}}{\partial t} + \nabla (v_{\alpha}S_{\alpha})= q_{\alpha}
\label{mass_balance}
\end{equation}
 
where $\phi$ represents the porosity, S represents the saturation and v is the saturation weighted Darcy velocity (such that $v_{\alpha}S_{\alpha}$ is the traditional Darcy velocity of phase p), and q is a volume source term, subject to the contrains on the saturation

\begin{equation}
\sum  S_{p}-1
\label{saturation_constrain}
\end{equation}

The Eq.\ref{saturation_constrain}, is discretized in time and space following the approach of \citet{Jackson_2013} in which the time discretization is obtained using the $\theta$-method as implemented by %\citet{gomes_2013}. 
Summing over all phases and discretizing in time using the $\theta$-method yields the global mass balance equation, Eq.\ref{global_mass_balance},

\begin{equation}
\begin{aligned}
\sum_{\alpha=1}^{N_{p}} {\int_{\Omega_{CVi}}} \! M_{i} \, \frac{\phi(S_{\alpha i}^{n+1})-(S_{\alpha i}^{n})}{\Delta t} dv + \\
& \cap \oint_{\Gamma_{CVi}} [\theta^{n+1/2}\; n\dot\;v_{p}^{n+1}S_{p}^{n+1}\;+\;(1-)\theta^{n+1/2}\;v_{p}^{n}S_{p}^{n}] d\Gamma \;- \\
& \cap \;\int_{\Omega_{CVi}} M_{i}q_{\alpha}^{n+\theta}dV\; }=0
\end{aligned}
\label{global_mass_balance}
\end{equation}

where $\Omega_{CVi}$ and $\Gamma_{CVi}$ are the volume and boundary of CV i respectively, n is normal vector of the CV and $\theta$ varies smoothly between $0.5$ (corresponding to CN) and $1$ (corresponding to BE) to avoid the introduction of spurious oscillations for large grid Courant numbers. The Eq.\ref{global_mass_balance} can be expressed in amtrix form at time level $n+1$ as
   

%%%         %%%
%%% SECTION %%%
%%%         %%%

\section{Brief Overview of Viscous Instabilities}\label{section:ViscousInstabilities}
%\textcolor{red}{KC: could you add 1-2 short paragraphs on viscous instabilities ... focus on the phenomena rather than a literature review, that may take place in the Intro Section}
As in many areas of fluid mechanics, the behaviour of the flow for conditions that exceed critical limits, are those that occur under highly critical conditions. Under this assumption, viscous fingering is no exception. It is a viscous driven hydrodynamic instability that results the collapse of the uniform interface between the fluids of different viscosity. This type of instability can be found across many research areas, disciplines and scales. Starting from small scale flow instabilities in Hele-Shaw cells that can provide the basic mathematical model, to coupled chromatographic separation systems for chemical and medical applications and reaching up to large scale reservoir systems.

However, one feature is common in the examples mentioned above and this is related with the mechanisms that govern these flows. Those three mechanisms are shielding, spreading and tip-splitting. Tip-splitting, Fig.~\ref{fig:shielding}(a), happens when a finger becomes unstable and splits into two branches. It is a function of Peclet number \textit{Pe}, which depends on the mobility ratio (MR). Spreading can be found mainly in porous medium when the flow velocity is not large and finally shielding, Fig.~\ref{fig:shielding}(b), occurs when one finger grows much faster than other fingers.


Viscous fingering has been found to influence industrial processes such as the removal of oil from reservoirs, the potential use of CO$_2$ sequestration and the re-mediation of spills, or the transport of pollutants in aquifers. The primary removal of oil from reservoirs leaves the porous reservoirs with remaining oil that can only be removed by the use of enhanced oil-recovery (EOR). This secondary and tertiary removal of oil from porous beds is required to be as efficient and economically viable as possible.
 

%(Oil \& Gas fields and pollutant dispersion in aquifers) the main %principle as well as mechanism has the same pattern.The difference in %large systems or Oil \& Gas fields, in particular for the Oil Industry %lies in the fact that the extraction and production of Hydrocarbons is %initially energy and financially crucial as well as computationally %expensive regarding the numerical modelling and simulation methods.

Regarding the mechanics, lets assume a porous medium, characterized by a constant permeability $K$. The flow will typically involve the displacement of a fluid of viscosity $\mu_1$  and density $\rho_1$ by a second of viscosity $\mu_2$ and density $\rho_2$. Under suitable continuum assumptions, Darcy's law, is used to describe the flow through a porous medium.

\begin{equation}
 U = \frac{b^2}{12 \mu} \nabla p
\end{equation}

and the above equation can be re-arranged for 1D steady flow as,

\begin{equation}
 \frac{dp}{dx}= - \frac{\mu U}{K} + \rho g 
\end{equation}


where, \textit{U}, is the velocity of the more viscous fluid, \textit{b}, is the cell gap (referring to Hele-Shaw cell) and \textit{$\nabla p$} is the pressure gradient.

Now consider a sharp interface or zone where density, viscosity, and solute concentration all change rapidly. Then the pressure force $(\rho_2-\rho_1)$ on the displaced fluid as a result of a virtual displacement $\delta_x$ of the interface from its simple convected location is 

\begin{equation}
\delta\rho=(\rho_2-\rho_1)=[[\frac{(\mu_1-\mu_2)U}{\kappa}]+(\rho_2-\rho_1)g] \delta\chi
\end{equation}

If the net pressure force is positive, then any small displacement will amplify, leading to an instability.In this case gravity is a stabilizing force while viscosity is destabilizing leading to critical velocity $U_c$ above which there is an instability.\\

\begin{equation}
U_c = \frac{(\rho_1-\rho_2) \cdot g \cdot K}{(\mu_1-\mu_2)}
\end{equation}

 
%%%         %%%
%%% SECTION %%%
%%%         %%%
\section{Model Validation}\label{section:ModelValidation}
 
%%%         %%%
%%% SECTION %%%
%%%         %%%
\subsection{Bucklet-Leverett Equation}\label{section:BuckletLeverettEquation}
\textcolor{red}{JG: text and simulation of P1DGP2, P1DGP1DG fixed and adaptive mesh -- quantitative analysis}\\
\textcolor{blue}{KC: do i have to mention something here?\\}

Models of water and another fluid, such as air, flowing through a
porous material, are used throughout science and
engineering.  Furthermore, individual chemical and biological
substances being transported in the fluids are often fundamentally
important. The mathematical models for these processes take several forms: scalar nonlinear parabolic equations (Richards' equation), scalar hyperbolic equations (Buckley-Leverett equation), systems of degenerate nonlinear parabolic systems (two-phase and compositional flow), and free boundary problems (Muskat's model). These are macroscopic continuum models that govern the distribution and evolution of quantities that are {\em averages} of the densities, pressures, and velocities arising in classical fluid mechanics. The basis of porous media models in microscopic physics is, however, incomplete: many observed phenomena such as history-dependent behavior and various other scale effects have not been satisfactorily modeled, particularly for multiphase,
multicomponent systems at the scale required for environmental
studies.

Modeling of two-phase immiscible flows in porous media is
important for many industrial applications, such as oil recovery and carbon sequestration. Mathematical conceptualizations for such flows include the BuckleyLeverett model, which, in its simplest form, is represented by a nonlinear advection equation for the relative saturation of fluid phases.This equation models the two phase flows that arise oil-recovery problems and physically
represents a mixture of oil and water through the porous medium.
In conservative form the flux function for this
problem is given by:

\begin{equation}
f(u) = \frac{u^2}{u^2 + \nu(1-u)^2}. \label{buckley}
\end{equation}
Here $\nu$ is viscosity ratio and $u$ represents the saturation of water and
lies between $0$ and $1$.

\subsection{Four Regions}\label{section:4Regions}
\textcolor{blue}{KC \textcolor{red}{WR}: text and simulations -- qualitative analysis}\\

Starting from the simplest case of simulations as describe in fig. \ref{fig:1}, there is a simple square shape formation consisted of 2 values of different (K) permeabilities. We inject fluid 1 across the left hand side of the formation and we are trying to displace the existing fluid 2. The front start to collapse and one main finger starts to appear.

The behaviour as well as the prediction of the two different phase volume fractions can be qualitatively compared with bibliographic results. The two phase volume volume fractions have the same but opposite behaviour across the length of the formation. As we inject fluid 1, at the first half of the formation the velocity magnitude is increasing while pressure drops gradually. This behaviour changes at the middle of the formation where there is the transition from one permeability zone to the other and the front has already collapsed forming the finger. 

From that point till the end of the formation, the velocity magnitute of the injected fluid remains the same having the minimum value since there is no more fluid 2 to be displaced. There is a sharp pressure drop which is also an indication that the fluid 2 cannot be pushed any further since at the same time, as can been seen from the graph plot at fig. \ref{fig:1} the phase volume fraction is constant. (\textcolor{blue}{KC: i think we can rephrase it better here.}) 

Later, we introduce two versions of a second set of simulations consisted of the same number of regions (4) but with different formations and phase ratios as can be described in fig. \ref{fig:2} to fig. \ref{fig:subim7}. 

The initial and boundary condition regarding the inlet and outlet are the same. The purpose is to expand this technique and introduce it into more complex formations so as to test it and develop a more stable and solid approach in real time and scale problems. 

The main body of the formation (blue area) is where fluid 2 exists fig. \ref{fig:3}. Above the blue area there are two layers - formations of different absolute permeabilities while in the main body there is a also a square shaped red coloured area where the two fluids exist in 50-50 phase ratio. All those ratios as well as the values of the permeabilities can be changes any time according to the data that are provided.

Fluid 1 is again injected across the left hand side of the formation. In this case the value of mobility or \textit{viscosity ratio} is 10. Later on mobility ratios of different values will be introduced and compared. As the flow is developed the initial uniform front collapses start forming fingers, areas where the flow is developed faster than the rest of the main body of the flow. The new unstructured and adaptive mesh with the $P_{n}DG-P_{n+1}$ element type is used in order to capture the flow development. In fig.\ref{fig:2} and fig.\ref{fig:3}) the mesh deforms on time and on space and that allows the user to have an initial good qualitative approach regarding the development of the multiphase flow. In fig. \ref{fig:subim6} and fig. \ref{fig:subim7} the patterns of the multiphase flows for the phase 1 and phase 2 are described respectively.

Based on the graph/plots for the second set of simulations we can get a initial approach and relation between the quantitative and qualitative outcome of our simulations. It is experimentally validated and is happening in this case that fingers will develop faster in areas where permeabilities are higher. This can be seen from the overall sharp increase of velocity magnitude during the injection of the fluid 1. Starting from the middle of the formation there is an increase in the velocity of the injected fluid but then it 'crashes' on the red square shape region where it slows down from the existence of both the fluid 1 \& fluid 2 that coexists. After flowing through this area there is a balance (plateau) among the two faces on time fig.\ref{fig:subim8 middle}. Going higher in the formation, fig.\ref{fig:subim9 up} in the next zone just above the main body (blue area), there is an initial fluctuating decrease  of the velocity of the injected fluid which is driven by the different permeability value. At the top layer ref.\ref{fig:subim10 upper} of the formation there is a smooth increase of the injected fluid velocity magnitude which basically describes an overall and study development of the flow while just before the end collapses. 

Comparing the three plots we can see three different velocities to be developed which means that numerically the initial uniform front collapses. This behaviour can be described on the following chapter, where the explanation of viscous instabilities is given.         
  

%%%         %%%
%%% SECTION %%%
%%%         %%%
\section{Viscous Instabilities}\label{section:ViscousInstabilities}

An accurate finite-element simulator with an adaptive and unstructured 2D grid was used in this study of viscous 
instabilities. An unfavourable - mobility-ratio displacement coupled with the heterogeneity of the porous medium results in viscous instability (fingering),which in turn affects the displacement efficiency of im/miscible processes as well as sweep efficiency and breakthrough time. Although numerical investigations 
in the last few years have remarkably improved the physical 
understanding of viscous fingering, some questions still remain 
unanswered.\\
 
First, how satisfactory are the effects of modelled-observed viscous fingering on displacement performance? Second, how 
is a viscous instability affected by parameters including mobility 
ratio and/or permeability variance. \textcolor{red}{ KC: something came to me right now, And third, can the viscous fingering be scaled?}  

\subsection{Designing the Numerical Experiment}\label{section:NumericalExperiment}
\textcolor{red}{WR: could add here a paragraph describing the original geometry and simulation set up (initial and boundary conditions)and maybe a table with the differences between the diff numerical experiments.}

The global mass balance equation and force balance equation are solving by vanishing the velocity term and solving the system of equations for pressure. At the $n+1$ step those two equations mentioned above can be rewritten as, 

\begin{equation}
M_{\sigma} {{\underline{u}}^{n+1}} = C {\underline{p}^{n+1}} + {\underline{s}_u ^{n+1}}
\label{mass balance eq}
\end{equation}

-------------------------------------------------------------------------------------------

\begin{equation}
B^T {{\underline{u}}^{n+1}} = {\underline{s}_p ^{n+1}}
\label{force balance eq}
\end{equation}

\noindent Application of a discontinuous FEM for velocity leads to a block-diagonal $M_{\sigma}$ matrix that can be readily inverted, each block being local to an element. This system of equations can be rewritten to produce the pressure equation, 

\begin{equation}
B^T M_{\sigma} ^{-1} C{{\underline{p}}^{n+1}} = {\underline{s}_p ^{n+1}} - B^T M_{\sigma} ^{-1} {{\underline{s}}^{n+1}} 
\label{pressure eq}
\end{equation}
-------------------------------------------------------------------------------------------
   

%%%         %%%
%%% SECTION %%%
%%%         %%%
\section{Brief Overview of Viscous Instabilities}\label{section:ViscousInstabilities}
%\textcolor{red}{KC: could you add 1-2 short paragraphs on viscous instabilities ... focus on the phenomena rather than a literature review, that may take place in the Intro Section}
As in many areas of fluid mechanics, the behaviour of the flow for conditions that exceed critical limits, are those that occur under highly critical conditions. Under this assumption, viscous fingering is no exception. It is a viscous driven hydrodynamic instability that results the collapse of the uniform interface between the fluids of different viscosity. This type of instability can be found across many research areas, disciplines and scales. Starting from small scale flow instabilities in Hele-Shaw cells that can provide the basic mathematical model, to coupled chromatographic separation systems for chemical and medical applications and reaching up to large scale reservoir systems.

However, one feature is common in the examples mentioned above and this is related with the mechanisms that govern these flows. Those three mechanisms are shielding, spreading and tip-splitting. Tip-splitting, Fig.~\ref{fig:shielding}(a), happens when a finger becomes unstable and splits into two branches. It is a function of Peclet number \textit{Pe}, which depends on the mobility ratio (MR). Spreading can be found mainly in porous medium when the flow velocity is not large and finally shielding, Fig.~\ref{fig:shielding}(b), occurs when one finger grows much faster than other fingers.

Viscous fingering has been found to influence industrial processes such as the removal of oil from reservoirs, the potential use of CO$_2$ sequestration and the re-mediation of spills, or the transport of pollutants in aquifers. The primary removal of oil from reservoirs leaves the porous reservoirs with remaining oil that can only be removed by the use of enhanced oil-recovery (EOR). This secondary and tertiary removal of oil from porous beds is required to be as efficient and economically viable as possible.

%(Oil \& Gas fields and pollutant dispersion in aquifers) the main %principle as well as mechanism has the same pattern.The difference in %large systems or Oil \& Gas fields, in particular for the Oil Industry %lies in the fact that the extraction and production of Hydrocarbons is %initially energy and financially crucial as well as computationally %expensive regarding the numerical modelling and simulation methods.

Regarding the mechanics, lets assume a porous medium, characterized by a constant permeability $K$. The flow will typically involve the displacement of a fluid of viscosity $\mu_1$  and density $\rho_1$ by a second of viscosity $\mu_2$ and density $\rho_2$. Under suitable continuum assumptions, Darcy's law, is used to describe the flow through a porous medium.

\begin{equation}
 U = \frac{b^2}{12 \mu} \nabla p
\end{equation}

and the above equation can be re-arranged for 1D steady flow as,

\begin{equation}
 \frac{dp}{dx}= - \frac{\mu U}{K} + \rho g 
\end{equation}


where, \textit{U}, is the velocity of the more viscous fluid, \textit{b}, is the cell gap (referring to Hele-Shaw cell) and \textit{$\nabla p$} is the pressure gradient.



Now consider a sharp interface or zone where density, viscosity, and solute concentration all change rapidly. Then the pressure force $(\rho_2-\rho_1)$ on the displaced fluid as a result of a virtual displacement $\delta_x$ of the interface from its simple convected location is 

\begin{equation}
\delta\rho=(\rho_2-\rho_1)=[[\frac{(\mu_1-\mu_2)U}{\kappa}]+(\rho_2-\rho_1)g] \delta\chi
\end{equation}

If the net pressure force is positive, then any small displacement will amplify, leading to an instability.In this case gravity is a stabilizing force while viscosity is destabilizing leading to critical velocity $U_c$ above which there is an instability.\\

\begin{equation}
U_c = \frac{(\rho_1-\rho_2) \cdot g \cdot K}{(\mu_1-\mu_2)}
\end{equation}

%%%         %%%
%%% SECTION %%%
%%%         %%%
\section{Model Validation}\label{section:ModelValidation}
 
%%%         %%%
%%% SECTION %%%
%%%         %%%
\subsection{Bucklet-Leverett Equation}\label{section:BuckletLeverettEquation}
\textcolor{red}{JG: text and simulation of P1DGP2, P1DGP1DG fixed and adaptive mesh -- quantitative analysis}\\
\textcolor{blue}{KC: do i have to mention something here?\\}

Models of water and another fluid, such as air, flowing through a
porous material, are used throughout science and
engineering.  Furthermore, individual chemical and biological
substances being transported in the fluids are often fundamentally
important. The mathematical models for these processes take several forms: scalar nonlinear parabolic equations (Richards' equation), scalar hyperbolic equations (Buckley-Leverett equation), systems of degenerate nonlinear parabolic systems (two-phase and compositional flow), and free boundary problems (Muskat's model). These are macroscopic continuum models that govern the distribution and evolution of quantities that are {\em averages} of the densities, pressures, and velocities arising in classical fluid mechanics. The basis of porous media models in microscopic physics is, however, incomplete: many observed phenomena such as history-dependent behavior and various other scale effects have not been satisfactorily modeled, particularly for multiphase,
multicomponent systems at the scale required for environmental
studies.

Modeling of two-phase immiscible flows in porous media is
important for many industrial applications, such as oil recovery and carbon sequestration. Mathematical conceptualizations for such flows include the BuckleyLeverett model, which, in its simplest form, is represented by a nonlinear advection equation for the relative saturation of fluid phases.This equation models the two phase flows that arise oil-recovery problems and physically
represents a mixture of oil and water through the porous medium.
In conservative form the flux function for this
problem is given by:

\begin{equation}
f(u) = \frac{u^2}{u^2 + \nu(1-u)^2}. \label{buckley}
\end{equation}
Here $\nu$ is viscosity ratio and $u$ represents the saturation of water and
lies between $0$ and $1$.

\subsection{Four Regions}\label{section:4Regions}
\textcolor{blue}{KC \textcolor{red}{WR}: text and simulations -- qualitative analysis}\\

Starting from the simplest case of simulations as describe in fig. \ref{fig:1}, there is a simple square shape formation consisted of 2 values of different (K) permeabilities. We inject fluid 1 across the left hand side of the formation and we are trying to displace the existing fluid 2. The front start to collapse and one main finger starts to appear.

The behaviour as well as the prediction of the two different phase volume fractions can be qualitatively compared with bibliographic results. The two phase volume volume fractions have the same but opposite behaviour across the length of the formation. As we inject fluid 1, at the first half of the formation the velocity magnitude is increasing while pressure drops gradually. This behaviour changes at the middle of the formation where there is the transition from one permeability zone to the other and the front has already collapsed forming the finger. 

From that point till the end of the formation, the velocity magnitute of the injected fluid remains the same having the minimum value since there is no more fluid 2 to be displaced. There is a sharp pressure drop which is also an indication that the fluid 2 cannot be pushed any further since at the same time, as can been seen from the graph plot at fig. \ref{fig:1} the phase volume fraction is constant. (\textcolor{blue}{KC: i think we can rephrase it better here.}) 

Later, we introduce two versions of a second set of simulations consisted of the same number of regions (4) but with different formations and phase ratios as can be described in fig. \ref{fig:2} to fig. \ref{fig:subim7}. 

The initial and boundary condition regarding the inlet and outlet are the same. The purpose is to expand this technique and introduce it into more complex formations so as to test it and develop a more stable and solid approach in real time and scale problems. 

The main body of the formation (blue area) is where fluid 2 exists fig. \ref{fig:3}. Above the blue area there are two layers - formations of different absolute permeabilities while in the main body there is a also a square shaped red coloured area where the two fluids exist in 50-50 phase ratio. All those ratios as well as the values of the permeabilities can be changes any time according to the data that are provided.

Fluid 1 is again injected across the left hand side of the formation. In this case the value of mobility or \textit{viscosity ratio} is 10. Later on mobility ratios of different values will be introduced and compared. As the flow is developed the initial uniform front collapses start forming fingers, areas where the flow is developed faster than the rest of the main body of the flow. The new unstructured and adaptive mesh with the $P_{n}DG-P_{n+1}$ element type is used in order to capture the flow development. In fig.\ref{fig:2} and fig.\ref{fig:3}) the mesh deforms on time and on space and that allows the user to have an initial good qualitative approach regarding the development of the multiphase flow. In fig. \ref{fig:subim6} and fig. \ref{fig:subim7} the patterns of the multiphase flows for the phase 1 and phase 2 are described respectively.

Based on the graph/plots for the second set of simulations we can get a initial approach and relation between the quantitative and qualitative outcome of our simulations. It is experimentally validated and is happening in this case that fingers will develop faster in areas where permeabilities are higher. This can be seen from the overall sharp increase of velocity magnitude during the injection of the fluid 1. Starting from the middle of the formation there is an increase in the velocity of the injected fluid but then it 'crashes' on the red square shape region where it slows down from the existence of both the fluid 1 \& fluid 2 that coexists. After flowing through this area there is a balance (plateau) among the two faces on time fig.\ref{fig:subim8 middle}. Going higher in the formation, fig.\ref{fig:subim9 up} in the next zone just above the main body (blue area), there is an initial fluctuating decrease  of the velocity of the injected fluid which is driven by the different permeability value. At the top layer ref.\ref{fig:subim10 upper} of the formation there is a smooth increase of the injected fluid velocity magnitude which basically describes an overall and study development of the flow while just before the end collapses. 

Comparing the three plots we can see three different velocities to be developed which means that numerically the initial uniform front collapses. This behaviour can be described on the following chapter, where the explanation of viscous instabilities is given.         
  

%%%         %%%
%%% SECTION %%%
%%%         %%%
\section{Viscous Instabilities}\label{section:ViscousInstabilities}

An accurate finite-element simulator with an adaptive and unstructured 2D grid was used in this study of viscous 
instabilities. An unfavourable - mobility-ratio displacement coupled with the heterogeneity of the porous medium results in viscous instability (fingering),which in turn affects the displacement efficiency of im/miscible processes as well as sweep efficiency and breakthrough time. Although numerical investigations 
in the last few years have remarkably improved the physical 
understanding of viscous fingering, some questions still remain 
unanswered.\\
 
First, how satisfactory are the effects of modelled-observed viscous fingering on displacement performance? Second, how 
is a viscous instability affected by parameters including mobility 
ratio and/or permeability variance. \textcolor{red}{ KC: something came to me right now, And third, can the viscous fingering be scaled?}  

\subsection{Designing the Numerical Experiment}\label{section:NumericalExperiment}
\textcolor{red}{WR: could add here a paragraph describing the original geometry and simulation set up (initial and boundary conditions)and maybe a table with the differences between the diff numerical experiments.}

The global mass balance equation and force balance equation are solving by vanishing the velocity term and solving the system of equations for pressure. At the $n+1$ step those two equations mentioned above can be rewritten as, 

\begin{equation}
M_{\sigma} {{\underline{u}}^{n+1}} = C {\underline{p}^{n+1}} + {\underline{s}_u ^{n+1}}
\label{mass balance eq}
\end{equation}

\begin{equation}
B^T {{\underline{u}}^{n+1}} = {\underline{s}_p ^{n+1}}
\label{force balance eq}
\end{equation}

\noindent Application of a discontinuous FEM for velocity leads to a block-diagonal $M_{\sigma}$ matrix that can be readily inverted, each block being local to an element. This system of equations can be rewritten to produce the pressure equation, 

\begin{equation}
B^T M_{\sigma} ^{-1} C{{\underline{p}}^{n+1}} = {\underline{s}_p ^{n+1}} - B^T M_{\sigma} ^{-1} {{\underline{s}}^{n+1}} 
\label{pressure eq}
\end{equation}

The computationally demanding effort to solve the pressure matrix equation (arising from the discontinuous FEM formulation) is achieved using a multigrid-like approach. 

The original geometry of the system is an orthogonal 2D domain where the  heterogeneity is imposed by introducing 4 distinct regions of four regions of different absolute permeabilities (K) as can being seen in fig.\ref{fig:1} and fig. \ref{fig:subim6}.   

The Richard equation (non-linear advection equation) for relative saturation fluid phases representing two phases immiscible flows in porous media has been simulated. The fluid $1$ or \textit{injected fluid} is injected a a velocity of $u_1 \phi = 1$. On the outlet, or right hand side boundary, the pressure level is set to zero and all the remaining boundary are naturally applied. All the simulations discussed in this section used the overlapping control volume FEM with a piecewise linear variation of the velocity with each element and quadratic pressure ($P_1 DG-P_2$). Saturation is collocated at the  pressure nodes and although it is calculated using a CV formulation, a FEM interpolation is used to form the higher order fluxes. There is no flow across the lower and upper boundaries (no-slip conditions) and the initial velocity of the fluid 2 or displaced fluid is set to zero, while the gravity is assumed negligible.   

%%%         %%%
%%% SECTION %%%
%%%         %%%
\subsection{Impact of Permeability Field}\label{section:PermeabilityAnalysis}

The higher the permeability of a medium, the easier it is for flow to propagate through it. Therefore, fluid will flow faster through the higher permeability region. Hence, in Case 1, it is expected that the injected fluid will flow fastest in the top layer which has the highest permeability. The second layer's permeability is higher than that of the bottom layer, so also, its front should be expected to move ahead of that of the bottom layer. The high permeability zone within the lower layer may result in some interesting flow characteristics at the horizontal flow boundary (the top and bottom boundary) depending on the difference between the two permeabilities. If this difference is sufficiently large enough, the fluid from the low permeability region will tend to cross into the high permeability region and flow forward from there. This will result in a region of reduced flow at these boundaries just beyond the deviation from normal flow and may also cause a stationary point at these boundaries within the flow.


\medskip
\textcolor{red}{WR: results }

%%%         %%%
%%% SECTION %%%
%%%         %%%
\subsection{Investigation of Viscosity (Mobility? I think its better if i keep as Mobility Ratio) Ratio}\label{section:MobilityAnalysis}
\textcolor{red}{KC: would you like to add a paragraph on the expected impact of MR in the flow?}\\
\medskip
\textcolor{red}{WR and KC: results}\\
%------------------------KC------------------------------------------

During the simulations performed the Viscous fingering phenomenon has been observed. Viscous fingering  is highly related with the mobility, which describes how easily a fluid moves into a porous media and can be expressed through the mobility ratio (\textit{MR}). The ratio between the mobility of the displacing phase to the mobility of the displaced. 

It generally accepted \textcolor{red}{can we say that...?} ( Saffman and Taylor, $1958$, Chouke et al., $1959$, Peters,$1979$ and Homsy,$1987$) that the higher the mobility ratio the easier is for viscous fingering to appear and more specific, for fingers to start to develop and grow. In the simulations above an $MR=10$ is used. This ration combined with the use of unstructured adaptive mesh makes the fingers more visible, easier to detect them. For cases where the is less than 5, ($MR \le 5$) we expect no difference as there is no significant impact. In the extreme case of $MR=1$ we can clearly see the relation between finger development and the zones of different porosity.      
%------------------------KC------------------------------------------

\pagebreak

%%%         %%%
%%% SECTION %%%
%%%         %%%
\section{Final Remarks}\label{section:conclusions}
%\textcolor{red}{KC and WR: do you want to have a bash on this ?}\\ 
%------------------------KC------------------------------------------


\KCnote{In the first set of simulations, saturation phase 2 is set to one throughout the whole domain ($S_2 = 1$) whereas fluid 1 is injected in the left boundary. Starting from fig.\ref{fig:1st} and ending to fig.\ref{fig:4th} the total transition from setting the simulations and using the elements mentioned in previous section, as well as the intermediate results and the final stage of simulations are described.

The number of elements used under the fixed coarse mesh approach is almost $5000$ elements and it is less than the instructed and adaptive mesh  grids which is around $20500$ elements while the max number has reached up to $24000$. The later mesh can focus the resolution inthe saturation front. In fig.\ref{fig:4} it can be seen that the high permeability square-region, where most of the fingers are formed are most noticeable.

In the case of both saturated/unsaturated porous media the square region is initially saturated with the fluid 1. The pattern of the initial inlet front is almost similar with the case mentioned above. The behaviour in the two top layers interface is initially inverse exponential followed by a direct decrease in the saturation front due to fingering. 

We proposed a surface-based approach to reservoir modelling. The new overlapping control volume finite element method for multi-fluid flows is based upon an dual consistent velocity-pressure representation in CV and FEM spaces introducing the element type family of $P_n DG P_{n+1}$.  
The aim of the paper is to extend apply the formulation to to multiphase flows in heterogeneous porous media. The above method is beneficial for two reasons. Firstly, numerical dispersion is reduced by adaptively refining the grid on time and space as the displacement front is evolving. Secondly the multi-scale heterogeneity can be better captured using the above mesh formation that can be adjusted to complex reservoir geometries over a wide variety of length-scales, without required the petrophysical properties to be rescaled each time that the mesh is changed.\\

\textcolor{blue}{The aim of this paper is to extend and further apply the formulation (embedded in the Fluidity software framework) to multiphase flows in heterogeneous porous media combined with either uniform or random generated permeability distribution. So far, the results illustrate that the displacing fluid tends to flow easier towards the zones with higher values of permeability (spatial acceleration / deceleration of flow  fingers formation). It can also be seen that finger like structure will remain connected as it travels towards the outlet while it will grow faster in zones with higher permeability. This behaviour is triggered by the permeability contrast among layers.
As can be seen from Fig........ the higher the viscosity ratio the easier it is for the uniform front of the injected fluid to break into fingers that will decrease the recovery of hydrocarbon content. Also, the higher the viscosity ratio, more to the right the breakpoint is shifted, in the time axis. The increased viscosity ratio increases the computational cost and requires the decrease of the solution's time-step.
Both the geometrical domain and the development of the flow, as can be seen in Fig........ follow the linear tip-splitting finger behaviour. In addition properties such as porosity and saturation can be readily up-scaled using statistical methods.%, like the python function that was introduced in the second case of the simulations, that provides fast and reasonable values.
To conclude, up-scaling or averaging the geological model can assist in running reservoir models faster and as close as possible to fine geological model.}\\

In conclusion the method that has been described in this paper as well as the simulations performed have a number of distinct advantages: 

\begin{enumerate}
\item[1.] The geological model can be designed from the beginning without any previous reference or geometrical limitations due to both the flexibility of method and to the fact that the geological characteristic and parameters can be easily introduced.
%\item[2.] Computational cost can be reduced because the complex geometries and surfaces are less expensive to generate and manage using fewer grid cells.
%\item[3.] The basis of the below argument is the flexibility and variance of the unstructured grid in time and space.
%\item[4.] Production simulations run directly on the geological model without the need to upscale.\\

\item[2.] The displacing fluid tends to flow easier towards the zones with higher values of permeability.
\item[3.] Finger-like structure will remain connected as it travels towards the outlet while it will grow faster in zones with higher permeability. This behaviour is triggered by the permeability contrast among layers.
\item[4.] The higher the viscosity ratio the easier it is for the uniform front of the injected fluid to break into fingers that will decrease the recovery of hydrocarbon content.
\item[5.] The increased viscosity ratio increases the computational cost and requires the use of smaller time-step sizes. At the same time the basis of the argument above is the flexibility and variance of the unstructured grid in time and space.
\item[6.] Both the geometrical domain and the development of the flow follow the linear tip-splitting finger behaviour.
\item[7.] Properties such as porosity and saturation can be readily up-scaled using statistical methods while production simulations run directly on the geological model without the need to upscale.

\end{enumerate} 
}
  


\noindent Even thought this model is promising there is still work to be done since it is not yet a complete product. Further work is required to develop the surface-based modelling algorithms.

%\textcolor{blue}{KC - Is it valid to include that part of this work has been published in international conferences and being awarded.}

   


%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%% \section{}
%% \label{}

%% References with bibTeX database:
\bibliographystyle{elsarticle-harv}
\bibliography{references}

\pagebreak
\clearpage

%\listoftables
%\pagebreak
%\input{Manuscript_Table}

\pagebreak
\clearpage

\listoffigures

\begin{figure}[h]
\makebox[\textwidth]{%
\includegraphics[width=0.49\textwidth]{./Pics/2b2_P1DGP2_perm}%
\hfill    
\includegraphics[width=0.49\textwidth]{./Pics/2b2_P1DGP2_mesh}%
}\\[0.5cm]% If you want some vertical space
\makebox[\textwidth]{%
\includegraphics[width=0.75\textwidth]{./Pics/2b2_P1DGP2_plot}%
}%
\caption{ Caption 1}
\label{fig:1}
\end{figure}
 
 
%\begin{figure}[h]
%\begin{center}
%\includegraphics[width=0.75\linewidth, height=7cm]{2b2_P1DGP2_perm} 
%\caption{Caption 1}
%\label{fig:subim1}
%\end{center}

%\begin{center}
%\includegraphics[width=0.75\linewidth, height=7cm]{2b2_P1DGP2_mesh} 
%\caption{Caption 1}
%\label{fig:subim1}
%\end{center}

%\begin{center}
%\centering
%\includegraphics[width=0.75\linewidth, height=6cm]{2b2_P1DGP2_plot}
%\caption{Caption 3}
%\label{fig:subim3}
%\end{center}
 
%\caption{Caption for this figure with two images}
%\label{fig:image1}
%\end{figure}
%\pagebreak
%\clearpage

\begin{figure}[h]
 
\begin{center}
\centering
\includegraphics[width=0.75\linewidth, height=5cm]{./Pics/P1DG-P2_element_type} 
\caption{Caption 2}
\label{fig:2}
\end{center}

\begin{center}
\centering
\includegraphics[width=0.8\linewidth, height=7cm]{./Pics/4r_po_adapt_fine_125_mesh} 
\caption{Caption 3}
\label{fig:3}
\end{center}

\begin{center}
\centering
\includegraphics[width=0.8\linewidth, height=7cm]{./Pics/4r_po_adapt_fine_100_mesh}
\caption{Caption 4}
\label{fig:4}
\end{center}
 
%\caption{Caption for this figure with two images}
\label{fig:image2}
\end{figure}
\pagebreak
\clearpage

\begin{landscape}
\begin{figure}[ht!]
\begin{center}
\subfigure[MR100, at the beginning of the simulations]{%
\label{fig:1st}
\includegraphics[width=0.75\textwidth]{./Pics/4r_po_adapt_fine_100}
}%
\subfigure[MR100, at the middle of the simulation]{%
\label{fig:2nd}
\includegraphics[width=0.75\textwidth]{./Pics/4r_po_adapt_fine_125_phase1_vol_fraction_mesh}
}\\
\subfigure[MR100, Phase 1 Volume fraction]{%
\label{fig:3rd}
\includegraphics[width=0.75\textwidth]{./Pics/4r_po_adapt_fine_125_phase1_vol_frac}
}%
\subfigure[MR100, Phase 2 Volume fraction]{%
\label{fig:4th}
\includegraphics[width=0.75\textwidth]{./Pics/4r_po_adapt_fine_125_phase2_vol_fraction}
}\\
\caption{Comparison of different MR's and their recovery rates}
\label{fig:5}
\end{center}
\end{figure}
\end{landscape}

\pagebreak
\clearpage
%\input{article_figure1}
%\input{Manuscript_Figure1}

\section{Results}\label{section:results}

The first example is a simple comparison between two cases using fixed mesh and mobility ratios of $1$ and $10$ respectively. The aspect ratio of the $2D$ domain is 2 and it favors viscous fingering effects while temperature is not taken into account (assume isothermal environment) and gravity effects are negligible. Fluid $1$ is initially injected from the left hand side with velocity $u_{inj}=1$. The domain is fully saturated with fluid $2$. At the outlet (right hand side) boundary pressure levels are set to zero while no slip boundary conditions are implied at the upper and lower part of the formation. Fixed time step sizes of $1 \times 10^{-3}$ for both the fixed meshes and the CFL number for this set of simulations is 5. The $P_{1}DGP_{2}$ element type with piecewise linear description of veleocity within each element and quadratic pressure representation as part of the OCVFEM method along with the discontinuous Galerkin method are implied and composing the mesh. Saturation is located at the pressure nodes. Five different regions of 5 distinct absolute permeabilities (K) are introduced (fig.\ref{fig:5regions_domain}). The red square region is saturated with a $50\%-50\%$ mixture of both phase $1$ and $2$. 

Two general behaviors for the interface may occur: (i) If a more viscous fluid displaces a less viscous one or a less viscous displaces a more viscous with a low average velocity, the interface is flat; (ii) if a less viscous fluid displaces a more viscous one with intermediate values of the average velocity, single or mutliple fingers will be observed.

This test-case serves as a base case for comparison between mobility (or viscocity) ratios that differ by an order of magnitude. Viscocity is a measure of resistance, therefore a frictional property. In these test-cases the $\sigma$ term as this is described above contains the individual parameters related with wettability and contact angle while the porous surface is a fluid $2$ wetted surface. For mobility ratios below $5$ the injection front will uniformly develop as time progress (piston shape front) and no fingers are expexted. Instabilities will start to occur and will be more obvious for mobility ratios higher than $5$. Between two layers or two regions with different permeabilities, but both saturated with fluid $2$, fingers will be triggered because of the permeability differences on the interface of these layers. In between the porous cappilary pressure difference with curve the interface and will lead to the formation of fingers. In macroscopic scale the interface between the two fluid will become unstable, an uneven or fingered profile will be controlled by capilary pressure -acting in the scale of the pores- and therefore due to the overall surface tension difference between the two immiscible fluids the front will collapse. This is of major practical importance in the petroleum industry, environmental waste remediation, and subsurface hydrology and it is key to understanding the movement of large volumes of injection fluids into subsurface reservoirs. The relationships between the capillarity of a geologic system, and the saturation and permeability of the fluids has a direct bearing on the migration speed and reservoir sweep of hydrocarbons affected the productivity of an oil field.

\KCnote{need to include some figures and analysis of the velocities, magnitude etc.}
\KCnote{ -to be placed in results-
 Even though some commercial simulators provide the user with option of an unstructured type of mesh still they are not able to dynamically adapt the mesh as the simulation develops and they increase the computational cost as the saturation front changes slowly. In this paper the use of dynamic mesh adaptivity to capture the viscous fingering in reservoir flows is introduced, as one of the methods that will allow the user to focus the effort where is needed, minimizing both the CPU time and the numerical diffusion. Both the evolution of visualisation techniques through the extensive use of parallel computing as well as the advances in modelling and simulation of porous media flows may help to address the importance of this phenomenon which can be found in petroleum, chemical and environmental operations.}

\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{./Pics1/mr1_fixed/permeability.png}
\caption{2D domain that consist of five regions with 5 different absolute permeabilities as these are represented with different colors.}
\label{fig:5regions_domain}
\end{center}
\end{figure}


\begin{figure}[H]
\begin{center}
\subfigure[MR1 fixed mesh start]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr1_fixed/mr1_fixed_100_2.png}
}%
\subfigure[MR10 fixed mesh start]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_fixed/mr10_fixed_100_1.png}
}\\
\subfigure[MR1 fixed mesh middle]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr1_fixed/mr1_fixed_middle_1.png}
}%
\subfigure[MR10 fixed mesh middle]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_fixed/mr10_fixed_middle_1.png}
}\\
\subfigure[MR1 fixed mesh end]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr1_fixed/mr1_fixed_end_2.png}
}\\
\subfigure[MR10 fixed mesh end]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_fixed/mr10_fixed_end_2.png}
}\\
\end{center}
\caption{Comparing MR1 and MR10 cases using fixed mesh. Simulation time step increases from top to bottom and from t=100(start) to t=3000(end).}
\label{fig:1testcase}
\end{figure}

Having already observed the significant growth of fingers comparing mobility ratios that differ an order of magnitude (Fig.\ref{fig:1testcase}), the next step is a comparison under the same mobility ratio of $10$, using the fixed and the adaptive mesh test case (Fig.\ref{fig:2testcase}).    

\begin{figure}[H]
\begin{center}
\subfigure[MR10 fixed mesh start]{%
\label{fig:first}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_fixed/5regions_fixed_250.png}
}%
\subfigure[MR10 adapt mesh start]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_adapt/5regions_adapt_250.png}
}\\
\subfigure[MR10 fixed mesh]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_fixed/5regions_fixed_500.png}
}%
\subfigure[MR10 adapt mesh]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_adapt/5regions_adapt_500.png}
}\\
\subfigure[MR10 fixed mesh]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_fixed/5regions_fixed_1500.png}
}%
\subfigure[MR10 adapt mesh]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_adapt/5regions_adapt_1500.png}
}\\ 
\subfigure[MR10 fixed mesh end]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_fixed/5regions_fixed_2000.png}
}\\
\subfigure[MR10 adapt mesh end]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_adapt/5regions_adapt_3000.png}
}\\
\end{center}
\caption{Comparing test-cases of fixed and adaptive mesh, using the $P_{1}DGP_{2}$ element type for MR=$10$ under the same time steps, t=250(a,b), t=500(c,d), t=1500(e,f), t=3000(g,h). When adaptive mesh is introduce there is better repersentation of the fluid instabilities as these are developed on time. }
\label{fig:2testcase}
\end{figure}

In fig.\ref{fig:3testcase} there is a comparison between a single and double injection of fluid $1$ into the formation. This time fluid $1$ is injected from both the left hand side and the upper left corner of the domain, at a velocity u=$0.5$ while the set up of the problem remains the same, the mobility ratio is $10$, and the adaptive and ustructured mesh is implied. The top layer is saturated with phase $2$, while the rest of the domain has a saturation of $0.1$. The major difference is located in the velocity fields as the presence of this extra inlet increases the flow at the top layers.

\begin{figure}[H]
\begin{center}
\subfigure[MR10 fixed mesh start]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_fixed_dinlet/5regions_dinlet_fixed_100.png}
}%
\subfigure[MR10 fixed adapt start]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_adapt_dinlet/5regions_dinlet_adapt_start.png}
}\\
\subfigure[MR10 fixed mesh t=1500]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_fixed_dinlet/5regions_dinlet_fixed_500.png}
}%
\subfigure[MR10 fixed adapt t=1500]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_adapt_dinlet/5regions_dinlet_adapt_500.png}
}\\
\subfigure[MR10 fixed mesh t=7500]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_fixed_dinlet/5regions_dinlet_fixed_2000.png}
}%
\subfigure[MR10 fixed adapt t=7500]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_adapt_dinlet/5regions_dinlet_adapt_2000.png}
}\\ 
\subfigure[MR10 fixed mesh end]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_fixed_dinlet/5regions_dinlet_fixed_end.png}
}\\
\subfigure[MR10 fixed adapt end]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr10_5regions_adapt_dinlet/5regions_dinlet_adapt_end.png}
}\\
\end{center}
\caption{Comparing the MR=$10$, between single and double injection of fluid $1$ under the adaptive and unstructured mesh for the same time steps, t=100(a,b), t=1500(c,d), t=7500(e,f), t=10000(g,h) }
\label{fig:3testcase}
\end{figure}

At this point is proper to mentioned the extreme case, see fig.{\ref{fig:4testcase}, when mobility ratio is even an order of magnitude higher, when MR=$100$. Even though a this case is unlikely to happen as the mobility ration of the existing fluids in the industry, it is a test-case that can illustrate the higher, faster and more profound development of instabilities.   

\begin{figure}[H]
%\begin{center}
\centering
\subfigure[MR100 fixed mesh t=500]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr100_fixed/mr100_fixed_500.png}
}%
\subfigure[MR100 fixed mesh t=1500]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr100_fixed/mr100_fixed_1500.png}
}%
\subfigure[MR100 fixed mesh t=3000]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr100_fixed/mr100_fixed_3000.png}
}\\ 
\subfigure[MR100 fixed mesh end]{%
\label{fig:}
\includegraphics[width=0.35\textwidth]{./Pics1/mr100_fixed/mr100_fixed_end.png}
}\\
%\end{center}
\caption{snapshots when the MR=$100$ using fixed and unstructured mesh for the same time steps, t=500(a), t=1500(b), t=3000(c), t=end(d) }
\label{fig:4testcase}
\end{figure}



\begin{figure}[H]
\begin{center}
\subfigure[MR1]{%
\label{fig:}
\includegraphics[width=0.6\textwidth]{./Pics/MR1.png}
}%
\subfigure[Recovery for MR1]{%
\label{fig:}
\includegraphics[width=0.52\textwidth]{./Pics/Recovery_MR1_1.png}
}\\
\subfigure[MR10]{%
\label{fig:}
\includegraphics[width=0.6\textwidth]{./Pics/MR10.png}
}%
\subfigure[Recovery for MR10]{%
\label{fig:}
\includegraphics[width=0.52\textwidth]{./Pics/Recovery_MR10_10.png}
}\\
\subfigure[MR100]{%
\label{fig:}
\includegraphics[width=0.6\textwidth]{./Pics/MR100_100_start.png}
}%
\subfigure[Recovery for MR100]{%
\label{fig:}
\includegraphics[width=0.52\textwidth]{./Pics/Recovery_MR100_100.png}
}\\ 
\end{center}
\caption{Comparison of different MR's and their recovery rates. The comparison among the MR = $1$,MR = $10$ and MR = $100$ has been done using the boundary conditions and set upt as this has already been describe in the beginning of the section \ref{section:results}. }
\label{fig:recoveryrates}
\end{figure}

The macroscopic sweep efficiency is principally affected by the heterogeneity in the reservoir which controls the spatial distribution of porosity and permeability. The permeability depends on the number, size and connectivity of the pores. This set of parameters is described by the $\sigma$ in the global mass balance equation (eq.\ref{global_mass_balance}). Including higher permeability zones also know as higher permeability channels or layers in the set up of the model, allows our test-cases to give a good approximation of the so called "thief zones", something that is common in heterogeneous geological formations. 
As can been seen so far in all the test-case illustrated, main differences can be found on the way the shape of fingering is developed. Adaptive meshes tend to display fingering easier because of the enhcanced and stronger resolution in the interface. Inside the high permeability square region there is an acceleration of the flow with the maximum value of it at the interface as this starts to develops at the back of this region and onwards. At this point attention should be given to the recovery rates as they can be illustrated from fig.{\ref{fig:recoveryrates}}. The breaking point, also known as the point the two curves meet where beyond that water production will occur, is shifted towards the right as MR is increased.



\section{Achknowledgements}
Mr William Rad\"unz would like to acknowledge the support from the Brazilian Research Council (CNPq) under the \textit{Science without Borders scholarship programme}. Mr Konstantinos Christou would like to acknowledge the support of the University of Aberdeen - College of Physical Science as well as the Aberdeen Formation Evaluation Society (\textit{AFES}). Last but not least credit should be given to both Dr Jefferson Gomes \& Dr Marcus Campell Bannerman, both lecturers at the University of Aberdeen, at the School of Engineering.

\end{document}
%% End of tex file.

%%  LocalWords:  checkboard
